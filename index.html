<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FitTracker Pro</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root {
            --bg-primary: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #252542;
            --accent-primary: #e94560;
            --accent-secondary: #ff6b6b;
            --accent-tertiary: #4ecdc4;
            --text-primary: #ffffff;
            --text-secondary: #b8b8d1;
            --text-muted: #6c6c8a;
            --success: #00d26a;
            --warning: #ffc107;
            --danger: #ff4757;
            --gradient-fire: linear-gradient(135deg, #e94560, #ff6b6b);
            --gradient-ocean: linear-gradient(135deg, #4ecdc4, #44a08d);
            --gradient-purple: linear-gradient(135deg, #667eea, #764ba2);
            --gradient-gold: linear-gradient(135deg, #f093fb, #f5576c);
            --gradient-force: linear-gradient(135deg, #ff416c, #ff4b2b);
            --gradient-volume: linear-gradient(135deg, #11998e, #38ef7d);
            --gradient-fullbody: linear-gradient(135deg, #fc4a1a, #f7b733);
            --gradient-crossfit: linear-gradient(135deg, #00b4db, #0083b0);
            --shadow-glow: 0 0 20px rgba(233, 69, 96, 0.3);
            --radius: 12px;
            --radius-lg: 20px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            display: flex;
            justify-content: space-around;
            padding: 10px 0 max(10px, env(safe-area-inset-bottom));
            border-top: 1px solid var(--bg-tertiary);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border: none;
            background: none;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: var(--radius);
        }

        .nav-item.active { color: var(--accent-primary); }
        .nav-item svg { width: 24px; height: 24px; }
        .nav-item span { font-size: 11px; font-weight: 500; }

        .main {
            padding: 20px;
            padding-bottom: 100px;
            max-width: 600px;
            margin: 0 auto;
        }

        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header { text-align: center; margin-bottom: 24px; }
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p { color: var(--text-secondary); margin-top: 4px; }

        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--bg-tertiary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title { font-size: 18px; font-weight: 600; }

        .card-badge {
            background: var(--gradient-fire);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn-primary {
            background: var(--gradient-fire);
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(233, 69, 96, 0.4);
        }

        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); }
        .btn-success { background: var(--gradient-ocean); color: white; }
        .btn-small { padding: 8px 16px; font-size: 14px; width: auto; }

        /* Cycle Card */
        .cycle-card {
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .cycle-card.force { background: var(--gradient-force); }
        .cycle-card.volume { background: var(--gradient-volume); }
        .cycle-card.mixte { background: var(--gradient-purple); }
        .cycle-card.fullbody { background: var(--gradient-fullbody); }

        .cycle-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .cycle-name { font-size: 22px; font-weight: 700; }
        .cycle-duration {
            background: rgba(255,255,255,0.2);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
        }

        .cycle-progress {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 8px;
            margin: 16px 0;
            overflow: hidden;
        }

        .cycle-progress-bar {
            height: 100%;
            background: white;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .cycle-stats {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            opacity: 0.9;
        }

        .no-cycle-card {
            background: var(--bg-tertiary);
            border: 2px dashed var(--text-muted);
            border-radius: var(--radius-lg);
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .no-cycle-card h3 {
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .no-cycle-card p {
            color: var(--text-muted);
            font-size: 14px;
            margin-bottom: 16px;
        }

        /* Program Selection */
        .program-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .program-card {
            border-radius: var(--radius-lg);
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .program-card:hover { transform: translateY(-4px); }

        .program-card.active {
            border-color: white;
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        .program-card.force { background: var(--gradient-force); }
        .program-card.volume { background: var(--gradient-volume); }
        .program-card.mixte { background: var(--gradient-purple); }
        .program-card.fullbody { background: var(--gradient-fullbody); }
        .program-card.crossfit { background: var(--gradient-crossfit); }

        .cycle-card.crossfit { background: var(--gradient-crossfit); }

        .program-icon { font-size: 40px; margin-bottom: 8px; }
        .program-name { font-size: 16px; font-weight: 700; margin-bottom: 4px; }
        .program-desc { font-size: 11px; opacity: 0.9; }

        .duration-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .duration-btn {
            flex: 1;
            min-width: 70px;
            padding: 12px 8px;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: var(--radius);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .duration-btn.active {
            border-color: var(--accent-primary);
            background: rgba(233, 69, 96, 0.2);
        }

        /* Exercise styles */
        .exercise-item {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .exercise-item:hover {
            transform: translateX(4px);
            border-left: 3px solid var(--accent-primary);
        }

        .exercise-item.completed {
            opacity: 0.6;
            border-left: 3px solid var(--success);
        }

        .exercise-item.active {
            border: 2px solid var(--accent-primary);
            box-shadow: var(--shadow-glow);
        }

        .exercise-name { font-weight: 600; margin-bottom: 4px; }
        .exercise-details { font-size: 14px; color: var(--text-secondary); }

        .exercise-biset {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed var(--text-muted);
        }

        .biset-badge {
            background: var(--gradient-purple);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        .bodyweight-badge {
            background: var(--gradient-ocean);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 8px;
        }

        .variant-badge {
            background: var(--gradient-gold);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 8px;
        }

        /* Timer */
        .timer-container {
            text-align: center;
            padding: 30px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
        }

        .timer-display {
            font-size: 64px;
            font-weight: 700;
            font-variant-numeric: tabular-nums;
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .timer-label { color: var(--text-secondary); margin-top: 8px; }

        /* Weight/Reps inputs */
        .weight-input-container {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            margin: 20px 0;
        }

        .weight-input {
            width: 100px;
            padding: 12px;
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            background: var(--bg-primary);
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius);
            color: var(--text-primary);
        }

        .weight-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .weight-unit { color: var(--text-secondary); font-size: 18px; }

        .weight-adjust {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 50%;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .weight-adjust:active {
            background: var(--accent-primary);
            transform: scale(0.95);
        }

        .reps-input-container {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            margin: 16px 0;
        }

        .reps-input {
            width: 80px;
            padding: 10px;
            font-size: 20px;
            font-weight: 600;
            text-align: center;
            background: var(--bg-primary);
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius);
            color: var(--text-primary);
        }

        .reps-label { color: var(--text-secondary); }

        /* Series Progress */
        .series-progress {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 16px 0;
        }

        .series-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            transition: all 0.3s ease;
        }

        .series-dot.completed { background: var(--success); }
        .series-dot.active {
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary);
            transform: scale(1.2);
        }

        /* Exercise Details Panel */
        .exercise-details-panel {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            margin-bottom: 16px;
            overflow: hidden;
            border: 1px solid var(--bg-tertiary);
        }

        .exercise-images {
            display: flex;
            gap: 12px;
            padding: 16px;
            background: var(--bg-tertiary);
            justify-content: center;
        }

        .exercise-images img {
            width: 48%;
            max-width: 225px;
            height: auto;
            border-radius: var(--radius);
            object-fit: cover;
            border: 2px solid var(--bg-primary);
        }

        .exercise-images .img-label {
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .exercise-img-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .exercise-img-container span {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .details-toggle {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .details-toggle:hover {
            background: var(--bg-primary);
        }

        .details-toggle .arrow {
            transition: transform 0.3s ease;
        }

        .details-toggle.open .arrow {
            transform: rotate(180deg);
        }

        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .details-content.open {
            max-height: 600px;
        }

        .details-section {
            padding: 12px 16px;
            border-top: 1px solid var(--bg-tertiary);
        }

        .details-section-title {
            font-size: 13px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .details-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .details-list li {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 4px 0;
            padding-left: 16px;
            position: relative;
        }

        .details-list li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--accent-tertiary);
        }

        .details-list.vigilance li::before {
            content: "‚ö†Ô∏è";
            font-size: 11px;
        }

        .muscles-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .muscle-tag {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }

        .muscle-tag.primary {
            background: var(--gradient-fire);
            color: white;
        }

        .muscle-tag.secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--bg-tertiary);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Chart */
        .chart-container {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .chart-select {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: var(--radius);
            font-size: 14px;
        }

        .chart-canvas { width: 100%; height: 200px; }

        /* History */
        .history-item {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            border: 1px solid var(--bg-tertiary);
        }

        .history-date { font-size: 12px; color: var(--text-muted); margin-bottom: 4px; }
        .history-title { font-weight: 600; margin-bottom: 8px; }
        .history-stats {
            display: flex;
            gap: 16px;
            font-size: 14px;
            color: var(--text-secondary);
            flex-wrap: wrap;
        }
        .history-stat { display: flex; align-items: center; gap: 4px; }

        /* Forms */
        .form-group { margin-bottom: 16px; }
        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        .form-input, .form-select {
            width: 100%;
            padding: 12px;
            background: var(--bg-primary);
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 16px;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        /* Session Type Cards */
        .session-type-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .session-type-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .session-type-card:hover { border-color: var(--accent-primary); }
        .session-type-card.active {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow-glow);
        }
        .session-type-icon { font-size: 32px; margin-bottom: 8px; }
        .session-type-name { font-weight: 600; }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
        }

        .modal.show { display: flex; }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 24px;
            max-width: 450px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title { font-size: 20px; font-weight: 600; }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 12px 24px;
            border-radius: var(--radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
            border: 1px solid var(--accent-primary);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Rest Timer Overlay */
        .rest-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 15, 26, 0.95);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2500;
        }

        .rest-overlay.show { display: flex; }

        .rest-timer {
            font-size: 120px;
            font-weight: 700;
            color: #4facfe;
        }

        .rest-label {
            font-size: 24px;
            color: var(--text-secondary);
            margin-bottom: 40px;
        }

        .rest-skip { margin-top: 40px; }

        /* Summary */
        .summary-card {
            background: var(--gradient-fire);
            border-radius: var(--radius-lg);
            padding: 24px;
            text-align: center;
            margin-bottom: 20px;
        }

        .summary-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }

        .summary-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .summary-stat { text-align: center; }
        .summary-stat-value { font-size: 28px; font-weight: 700; }
        .summary-stat-label { font-size: 12px; opacity: 0.8; }

        /* Cycle Bilan */
        .bilan-section {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 16px;
        }

        .bilan-title {
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bilan-stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--bg-secondary);
        }

        .bilan-stat-row:last-child { border-bottom: none; }

        .bilan-improvement {
            color: var(--success);
            font-weight: 600;
        }

        .bilan-improvement.negative { color: var(--danger); }

        /* Settings */
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .settings-label { font-weight: 500; }
        .settings-desc { font-size: 12px; color: var(--text-muted); }

        .toggle { position: relative; width: 50px; height: 26px; }
        .toggle input { opacity: 0; width: 0; height: 0; }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-tertiary);
            border-radius: 26px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background: white;
            border-radius: 50%;
            transition: 0.3s;
        }

        .toggle input:checked + .toggle-slider { background: var(--accent-primary); }
        .toggle input:checked + .toggle-slider:before { transform: translateX(24px); }

        .data-buttons { display: flex; gap: 12px; margin-top: 16px; }
        .data-buttons .btn { flex: 1; }

        /* Warmup */
        .warmup-card {
            background: linear-gradient(135deg, #ff9a56, #ff6b6b);
            border-radius: var(--radius-lg);
            padding: 16px;
            margin-bottom: 16px;
        }

        .warmup-title { font-weight: 600; margin-bottom: 8px; }
        .warmup-list { font-size: 14px; opacity: 0.9; }
        .warmup-list li { margin-left: 16px; margin-bottom: 4px; }

        /* Mode selection */
        .mode-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .mode-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: 24px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .mode-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .mode-card.active {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow-glow);
            background: rgba(233, 69, 96, 0.1);
        }

        .mode-icon { font-size: 48px; margin-bottom: 12px; }
        .mode-name { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .mode-desc { font-size: 12px; color: var(--text-secondary); }

        /* Next session */
        .next-session {
            background: var(--gradient-purple);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        .next-session-label { font-size: 12px; opacity: 0.8; margin-bottom: 4px; }
        .next-session-title { font-size: 20px; font-weight: 700; }
        .next-session-desc { font-size: 14px; opacity: 0.9; margin-top: 8px; }

        /* Weight Goal Card */
        .weight-goal-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
        }

        .weight-goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .weight-goal-title { font-weight: 600; }

        .weight-current {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .weight-target { font-size: 14px; opacity: 0.9; }

        .weight-progress-bar {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 10px;
            margin: 16px 0;
            overflow: hidden;
        }

        .weight-progress-fill {
            height: 100%;
            background: white;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .weight-stats {
            font-size: 13px;
            opacity: 0.9;
            display: flex;
            justify-content: space-between;
        }

        /* Sessions indicator */
        .sessions-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            margin-bottom: 16px;
        }

        .sessions-indicator.reached { background: rgba(0, 210, 106, 0.2); }
        .sessions-indicator.reached .sessions-count { color: var(--success); }

        .sessions-count { font-weight: 700; font-size: 18px; }
        .sessions-label { font-size: 14px; color: var(--text-secondary); }

        /* Settings sections */
        .settings-section {
            margin-bottom: 24px;
        }

        .settings-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Level badges */
        .level-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .level-badge.debutant { background: var(--gradient-ocean); }
        .level-badge.intermediaire { background: var(--gradient-purple); }
        .level-badge.avance { background: var(--gradient-fire); }

        /* CrossFit styles */
        .wod-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 16px;
            max-height: 200px;
            overflow-y: auto;
        }

        .wod-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .wod-card:hover { border-color: var(--accent-tertiary); }
        .wod-card.active {
            border-color: var(--accent-tertiary);
            background: rgba(78, 205, 196, 0.2);
        }

        .wod-name { font-weight: 600; font-size: 14px; }
        .wod-type { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

        .crossfit-type-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 16px;
        }

        .crossfit-type-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 16px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .crossfit-type-card:hover { border-color: var(--accent-tertiary); }
        .crossfit-type-card.active {
            border-color: var(--accent-tertiary);
            background: rgba(78, 205, 196, 0.2);
        }

        .crossfit-type-icon { font-size: 28px; margin-bottom: 6px; }
        .crossfit-type-name { font-size: 13px; font-weight: 600; }

        .wod-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .wod-tab {
            flex: 1;
            padding: 10px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: var(--radius);
            color: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .wod-tab.active {
            background: var(--gradient-crossfit);
            color: white;
        }

        .random-wod-btn {
            background: var(--gradient-crossfit);
            color: white;
            border: none;
            border-radius: var(--radius);
            padding: 16px;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .random-wod-btn:hover { opacity: 0.9; }

        /* Footer credit */
        .powered-by {
            text-align: center;
            padding: 16px;
            padding-bottom: 80px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .powered-by a {
            color: var(--accent-tertiary);
            text-decoration: none;
        }

        .wod-preview {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 16px;
        }

        .wod-preview-title {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--accent-tertiary);
        }

        .wod-preview-type {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .wod-preview-exercises {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="toast" id="toast"></div>

    <div class="rest-overlay" id="restOverlay">
        <div class="rest-label">Repos</div>
        <div class="rest-timer" id="restTimer">60</div>
        <button class="btn btn-secondary rest-skip" onclick="skipRest()">Passer</button>
    </div>

    <main class="main">
        <!-- Home Page -->
        <section class="page active" id="homePage">
            <div class="header">
                <h1>FitTracker Pro</h1>
                <p id="greeting">Pr√™t √† t'entra√Æner ?</p>
            </div>

            <!-- Cycle actif ou proposition -->
            <div id="cycleDisplay"></div>

            <!-- Indicateur s√©ances/semaine -->
            <div class="sessions-indicator" id="sessionsIndicator">
                <span class="sessions-count" id="sessionsCountDisplay">0/4</span>
                <span class="sessions-label">s√©ances cette semaine</span>
            </div>

            <!-- Objectif poids -->
            <div class="weight-goal-card" id="weightGoalCard" style="display: none;">
                <div class="weight-goal-header">
                    <span class="weight-goal-title">Objectif poids</span>
                    <button class="btn btn-small" style="background: rgba(255,255,255,0.2); padding: 6px 12px;" onclick="openWeightEntryModal()">+ Pes√©e</button>
                </div>
                <div class="weight-current" id="weightCurrentDisplay">-- kg</div>
                <div class="weight-target" id="weightTargetDisplay">Objectif: -- kg</div>
                <div class="weight-progress-bar">
                    <div class="weight-progress-fill" id="weightProgressFill" style="width: 0%;"></div>
                </div>
                <div class="weight-stats">
                    <span id="weightWeeklyChange">--</span>
                    <span id="weightRemaining">-- kg restants</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="weekSessions">0</div>
                    <div class="stat-label">S√©ances cette semaine</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalVolume">0</div>
                    <div class="stat-label">Kg soulev√©s (semaine)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalSessions">0</div>
                    <div class="stat-label">S√©ances totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="currentStreak">0</div>
                    <div class="stat-label">Jours cons√©cutifs</div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="startWorkout()" id="startWorkoutBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Commencer la s√©ance
            </button>

            <div style="margin-top: 16px; display: flex; gap: 12px;">
                <button class="btn btn-secondary" style="flex: 1;" onclick="showCardioForm()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    Cardio
                </button>
                <button class="btn btn-secondary" style="flex: 1; background: var(--gradient-crossfit);" onclick="showCrossfitForm()">
                    üèãÔ∏è CrossFit
                </button>
            </div>

            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <span class="card-title">Derni√®res s√©ances</span>
                </div>
                <div id="recentSessions">
                    <p style="color: var(--text-muted); text-align: center;">Aucune s√©ance enregistr√©e</p>
                </div>
            </div>
        </section>

        <!-- Workout Page -->
        <section class="page" id="workoutPage">
            <div class="header">
                <h1 id="workoutTitle">Upper A</h1>
                <p id="workoutSubtitle">S√©ance en cours</p>
            </div>

            <div class="warmup-card" id="warmupCard">
                <div class="warmup-title">√âchauffement (5-10 min)</div>
                <ul class="warmup-list" id="warmupList">
                    <li>2 min corde √† sauter</li>
                    <li>Rotations d'√©paules</li>
                    <li>Mobilit√© articulaire</li>
                    <li>1 s√©rie l√©g√®re du 1er exercice</li>
                </ul>
                <button class="btn btn-small" style="margin-top: 12px; background: rgba(255,255,255,0.2);" onclick="hideWarmup()">C'est fait !</button>
            </div>

            <div class="timer-container">
                <div class="timer-display" id="mainTimer">00:00</div>
                <div class="timer-label">Temps total</div>
            </div>

            <div id="exercisesList"></div>

            <button class="btn btn-success" id="finishWorkoutBtn" onclick="finishWorkout()">
                Terminer la s√©ance
            </button>
        </section>

        <!-- Exercise Page -->
        <section class="page" id="exercisePage">
            <div class="header">
                <h1 id="exerciseTitle">Exercice</h1>
                <p id="exerciseInfo">4 s√©ries x 8-12 reps</p>
            </div>

            <div class="series-progress" id="seriesProgress"></div>

            <!-- Exercise Details Panel -->
            <div class="exercise-details-panel" id="exerciseDetailsPanel" style="display: none;">
                <div class="exercise-images" id="exerciseImages">
                    <div class="exercise-img-container">
                        <img id="exerciseImg1" src="" alt="Position d√©part">
                        <span>D√©part</span>
                    </div>
                    <div class="exercise-img-container">
                        <img id="exerciseImg2" src="" alt="Position fin">
                        <span>Fin</span>
                    </div>
                </div>
                <button class="details-toggle" id="detailsToggle" onclick="toggleExerciseDetails()">
                    <span>Voir les instructions</span>
                    <span class="arrow">‚ñº</span>
                </button>
                <div class="details-content" id="detailsContent">
                    <div class="details-section">
                        <div class="details-section-title">üìã Ex√©cution</div>
                        <ul class="details-list" id="executionList"></ul>
                    </div>
                    <div class="details-section">
                        <div class="details-section-title">‚ö†Ô∏è Points de vigilance</div>
                        <ul class="details-list vigilance" id="vigilanceList"></ul>
                    </div>
                    <div class="details-section">
                        <div class="details-section-title">üí™ Muscles travaill√©s</div>
                        <div class="muscles-tags" id="musclesTags"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-title">S√©rie <span id="currentSeries">1</span>/<span id="totalSeriesCount">4</span></span>
                    <span class="card-badge" id="seriesBadge">En cours</span>
                </div>

                <div class="weight-input-container" id="weightContainer">
                    <button class="weight-adjust" onclick="adjustWeight(-2.5)">-</button>
                    <input type="number" class="weight-input" id="weightInput" value="50" step="2.5">
                    <span class="weight-unit">kg</span>
                    <button class="weight-adjust" onclick="adjustWeight(2.5)">+</button>
                </div>

                <div id="bodyweightIndicator" style="display: none; text-align: center; padding: 16px; background: var(--bg-primary); border-radius: var(--radius); margin: 20px 0;">
                    <span style="font-size: 32px;">üèãÔ∏è</span>
                    <p style="color: var(--accent-tertiary); font-weight: 600; margin-top: 8px;">Poids de corps</p>
                </div>

                <div class="reps-input-container">
                    <button class="weight-adjust" onclick="adjustReps(-1)">-</button>
                    <input type="number" class="reps-input" id="repsInput" value="10">
                    <span class="reps-label">r√©p√©titions</span>
                    <button class="weight-adjust" onclick="adjustReps(1)">+</button>
                </div>
            </div>

            <button class="btn btn-primary" onclick="validateSeries()">Valider la s√©rie</button>

            <div style="margin-top: 12px;">
                <button class="btn btn-secondary" onclick="backToExercises()">Retour aux exercices</button>
            </div>
        </section>

        <!-- Stats Page -->
        <section class="page" id="statsPage">
            <div class="header">
                <h1>Statistiques</h1>
                <p>Suivi de ta progression</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="statTotalSessions">0</div>
                    <div class="stat-label">S√©ances totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTotalVolume">0</div>
                    <div class="stat-label">Tonnes soulev√©es</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statTotalTime">0</div>
                    <div class="stat-label">Heures d'entra√Ænement</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statCardioCount">0</div>
                    <div class="stat-label">Sorties cardio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statCrossfitCount">0</div>
                    <div class="stat-label">S√©ances CrossFit</div>
                </div>
            </div>

            <div class="chart-container" id="weightChartContainer" style="display: none;">
                <div class="chart-header">
                    <span class="card-title">Suivi du poids</span>
                </div>
                <canvas class="chart-canvas" id="weightChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-header">
                    <span class="card-title">Progression muscu</span>
                    <select class="chart-select" id="exerciseSelect" onchange="updateChart()">
                        <option value="volume">Volume total</option>
                    </select>
                </div>
                <canvas class="chart-canvas" id="progressChart"></canvas>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-title">Historique</span>
                </div>
                <div id="historyList"></div>
            </div>
        </section>

        <!-- Settings Page -->
        <section class="page" id="settingsPage">
            <div class="header">
                <h1>Param√®tres</h1>
            </div>

            <!-- Profil utilisateur -->
            <div class="card">
                <div class="settings-section-title">Profil</div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">Niveau</div>
                        <div class="settings-desc">Adapte les s√©ries et repos</div>
                    </div>
                    <select class="form-select" style="width: auto;" id="userLevelSelect" onchange="updateUserLevel()">
                        <option value="debutant">D√©butant</option>
                        <option value="intermediaire" selected>Interm√©diaire</option>
                        <option value="avance">Avanc√©</option>
                    </select>
                </div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">S√©ances par semaine</div>
                        <div class="settings-desc">Objectif hebdomadaire</div>
                    </div>
                    <select class="form-select" style="width: auto;" id="sessionsPerWeekSelect" onchange="updateSessionsPerWeek()">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">Bisets (supersets)</div>
                        <div class="settings-desc">Exercices encha√Æn√©s</div>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" id="bisetToggle" checked onchange="toggleBiset()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Objectif poids -->
            <div class="card">
                <div class="settings-section-title">Objectif poids</div>
                <div id="weightGoalSettingsInfo">
                    <p style="color: var(--text-muted); font-size: 14px;">Aucun objectif d√©fini</p>
                </div>
                <div style="display: flex; gap: 8px; margin-top: 12px;">
                    <button class="btn btn-small btn-secondary" onclick="openWeightGoalModal()">D√©finir objectif</button>
                    <button class="btn btn-small btn-secondary" onclick="openWeightEntryModal()" id="addWeightBtn" style="display: none;">+ Pes√©e</button>
                </div>
            </div>

            <!-- Entra√Ænement -->
            <div class="card">
                <div class="settings-section-title">Entra√Ænement</div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">Sons</div>
                        <div class="settings-desc">Notifications sonores</div>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" id="soundToggle" checked onchange="toggleSound()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">Temps de repos</div>
                        <div class="settings-desc">Entre les s√©ries</div>
                    </div>
                    <select class="form-select" style="width: auto;" id="restTimeSelect" onchange="updateRestTime()">
                        <option value="60">60s</option>
                        <option value="75">75s</option>
                        <option value="90" selected>90s</option>
                        <option value="120">120s</option>
                        <option value="150">150s</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <div class="settings-section-title">Cycle actuel</div>
                <div id="cycleSettingsInfo"></div>
                <button class="btn btn-small btn-secondary" style="margin-top: 12px;" onclick="showProgramSelection()">
                    Changer de programme
                </button>
            </div>

            <div class="card">
                <div class="settings-section-title">Donn√©es</div>

                <div class="settings-item">
                    <div>
                        <div class="settings-label">Export automatique</div>
                        <div class="settings-desc">Sauvegarder apr√®s chaque s√©ance</div>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" id="autoExportToggle" onchange="toggleAutoExport()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="data-buttons">
                    <button class="btn btn-secondary btn-small" onclick="exportData()">Exporter</button>
                    <button class="btn btn-secondary btn-small" onclick="document.getElementById('importInput').click()">Importer</button>
                    <input type="file" id="importInput" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
                <div style="margin-top: 16px;">
                    <button class="btn btn-small" style="background: var(--danger);" onclick="confirmReset()">R√©initialiser</button>
                </div>
            </div>
        </section>

        <div class="powered-by">
            Powered by <a href="https://github.com/nioki50" target="_blank">nioki50</a>
        </div>
    </main>

    <!-- Program Selection Modal -->
    <div class="modal" id="programModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Choisis ton programme</span>
                <button class="modal-close" onclick="closeProgramModal()">&times;</button>
            </div>

            <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 14px;">
                Chaque programme a son objectif. Tu pourras changer √† la fin du cycle.
            </p>

            <div class="program-grid" id="programGrid">
                <div class="program-card force active" data-program="force" onclick="selectProgram('force')">
                    <div class="program-icon">üî•</div>
                    <div class="program-name">Force</div>
                    <div class="program-desc">4-6 reps, charges lourdes</div>
                </div>
                <div class="program-card volume" data-program="volume" onclick="selectProgram('volume')">
                    <div class="program-icon">üí™</div>
                    <div class="program-name">Volume</div>
                    <div class="program-desc">10-15 reps, hypertrophie</div>
                </div>
                <div class="program-card mixte" data-program="mixte" onclick="selectProgram('mixte')">
                    <div class="program-icon">‚ö°</div>
                    <div class="program-name">Mixte</div>
                    <div class="program-desc">8-12 reps, polyvalent</div>
                </div>
                <div class="program-card fullbody" data-program="fullbody" onclick="selectProgram('fullbody')">
                    <div class="program-icon">üéØ</div>
                    <div class="program-name">Full Body</div>
                    <div class="program-desc">3 s√©ances compl√®tes</div>
                </div>
                <div class="program-card crossfit" data-program="crossfit" onclick="selectProgram('crossfit')">
                    <div class="program-icon">üèãÔ∏è</div>
                    <div class="program-name">CrossFit</div>
                    <div class="program-desc">WOD, Halt√©ro & Gym</div>
                </div>
            </div>

            <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 14px;">Dur√©e du cycle :</p>
            <div class="duration-selector" id="durationSelector">
                <button class="duration-btn" data-weeks="4" onclick="selectDuration(4)">4 sem.</button>
                <button class="duration-btn" data-weeks="6" onclick="selectDuration(6)">6 sem.</button>
                <button class="duration-btn active" data-weeks="8" onclick="selectDuration(8)">8 sem.</button>
                <button class="duration-btn" data-weeks="12" onclick="selectDuration(12)">12 sem.</button>
            </div>

            <button class="btn btn-primary" onclick="startCycle()">D√©marrer le cycle</button>
        </div>
    </div>

    <!-- Mode Selection Modal -->
    <div class="modal" id="modeModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Mode d'entra√Ænement</span>
                <button class="modal-close" onclick="closeModeModal()">&times;</button>
            </div>

            <div id="modeSessionInfo" style="text-align: center; margin-bottom: 16px;">
                <h3 style="color: var(--accent-primary);" id="modeSessionTitle">Upper A</h3>
            </div>

            <div class="mode-selection">
                <div class="mode-card active" data-mode="normal" onclick="selectWorkoutMode('normal')">
                    <div class="mode-icon">üèãÔ∏è</div>
                    <div class="mode-name">Normal</div>
                    <div class="mode-desc">√âquipement complet</div>
                </div>
                <div class="mode-card" data-mode="bodyweight" onclick="selectWorkoutMode('bodyweight')">
                    <div class="mode-icon">üß≥</div>
                    <div class="mode-name">Voyage</div>
                    <div class="mode-desc">Poids de corps</div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="confirmWorkoutMode()">C'est parti !</button>
        </div>
    </div>

    <!-- Cycle End Modal -->
    <div class="modal" id="cycleEndModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Bilan du cycle</span>
                <button class="modal-close" onclick="closeCycleEndModal()">&times;</button>
            </div>

            <div id="cycleEndContent"></div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="extendCycle()">Prolonger 4 sem.</button>
                <button class="btn btn-primary" onclick="showProgramSelection()">Nouveau cycle</button>
            </div>
        </div>
    </div>

    <!-- Cardio Modal -->
    <div class="modal" id="cardioModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Sortie cardio</span>
                <button class="modal-close" onclick="closeCardioModal()">&times;</button>
            </div>

            <div class="session-type-grid">
                <div class="session-type-card active" data-type="running" onclick="selectCardioType('running')">
                    <div class="session-type-icon">üèÉ</div>
                    <div class="session-type-name">Course</div>
                </div>
                <div class="session-type-card" data-type="cycling" onclick="selectCardioType('cycling')">
                    <div class="session-type-icon">üö¥</div>
                    <div class="session-type-name">V√©lo</div>
                </div>
                <div class="session-type-card" data-type="swimming" onclick="selectCardioType('swimming')">
                    <div class="session-type-icon">üèä</div>
                    <div class="session-type-name">Piscine</div>
                </div>
                <div class="session-type-card" data-type="other" onclick="selectCardioType('other')">
                    <div class="session-type-icon">üí™</div>
                    <div class="session-type-name">Autre</div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Dur√©e (minutes)</label>
                <input type="number" class="form-input" id="cardioDuration" placeholder="30">
            </div>

            <div class="form-group">
                <label class="form-label">Distance (km)</label>
                <input type="number" class="form-input" id="cardioDistance" placeholder="5" step="0.1">
            </div>

            <div class="form-group">
                <label class="form-label">D√©nivel√© (m)</label>
                <input type="number" class="form-input" id="cardioElevation" placeholder="0">
            </div>

            <button class="btn btn-success" onclick="saveCardioSession()">Enregistrer</button>
        </div>
    </div>

    <!-- CrossFit Modal -->
    <div class="modal" id="crossfitModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">üèãÔ∏è S√©ance CrossFit</span>
                <button class="modal-close" onclick="closeCrossfitModal()">&times;</button>
            </div>

            <div class="crossfit-type-grid">
                <div class="crossfit-type-card active" data-cftype="wod" onclick="selectCrossfitType('wod')">
                    <div class="crossfit-type-icon">üî•</div>
                    <div class="crossfit-type-name">WOD</div>
                </div>
                <div class="crossfit-type-card" data-cftype="haltero" onclick="selectCrossfitType('haltero')">
                    <div class="crossfit-type-icon">üèãÔ∏è‚Äç‚ôÇÔ∏è</div>
                    <div class="crossfit-type-name">Halt√©ro</div>
                </div>
                <div class="crossfit-type-card" data-cftype="gym" onclick="selectCrossfitType('gym')">
                    <div class="crossfit-type-icon">ü§∏</div>
                    <div class="crossfit-type-name">Gym</div>
                </div>
            </div>

            <!-- WOD Section -->
            <div id="wodSection">
                <div class="wod-tabs">
                    <button class="wod-tab active" onclick="switchWodTab('random')">üé≤ Al√©atoire</button>
                    <button class="wod-tab" onclick="switchWodTab('select')">üìã Choisir</button>
                </div>

                <div id="wodRandomTab">
                    <button class="random-wod-btn" onclick="generateRandomWod()">
                        üé≤ G√©n√©rer un WOD al√©atoire
                    </button>
                </div>

                <div id="wodSelectTab" style="display: none;">
                    <div class="wod-grid" id="wodGrid"></div>
                </div>

                <div id="wodPreview" class="wod-preview" style="display: none;">
                    <div class="wod-preview-title" id="wodPreviewName">-</div>
                    <div class="wod-preview-type" id="wodPreviewType">-</div>
                    <div class="wod-preview-exercises" id="wodPreviewExercises">-</div>
                </div>
            </div>

            <!-- Haltero/Gym Section -->
            <div id="halteroGymSection" style="display: none;">
                <p style="color: var(--text-secondary); text-align: center; margin-bottom: 16px;">
                    S√©ance technique pr√©d√©finie
                </p>
            </div>

            <div class="form-group">
                <label class="form-label">Dur√©e (minutes)</label>
                <input type="number" class="form-input" id="crossfitDuration" placeholder="30">
            </div>

            <div class="form-group" id="crossfitRoundsGroup">
                <label class="form-label">Rounds compl√©t√©s</label>
                <input type="number" class="form-input" id="crossfitRounds" placeholder="5">
            </div>

            <div class="form-group">
                <label class="form-label">Notes</label>
                <input type="text" class="form-input" id="crossfitNotes" placeholder="RX, scaled, temps...">
            </div>

            <button class="btn btn-success" onclick="saveCrossfitSession()">Enregistrer</button>
        </div>
    </div>

    <!-- Summary Modal -->
    <div class="modal" id="summaryModal">
        <div class="modal-content">
            <div class="summary-card">
                <div class="summary-title">S√©ance termin√©e !</div>
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summaryDuration">00:00</div>
                        <div class="summary-stat-label">Dur√©e</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summaryVolume">0</div>
                        <div class="summary-stat-label">Kg soulev√©s</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summarySeries">0</div>
                        <div class="summary-stat-label">S√©ries</div>
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="closeSummary()">Super !</button>
        </div>
    </div>

    <!-- Weight Goal Modal -->
    <div class="modal" id="weightGoalModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Objectif poids</span>
                <button class="modal-close" onclick="closeWeightGoalModal()">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">Poids actuel (kg)</label>
                <input type="number" class="form-input" id="weightGoalStart" placeholder="85" step="0.1">
            </div>

            <div class="form-group">
                <label class="form-label">Poids cible (kg)</label>
                <input type="number" class="form-input" id="weightGoalTarget" placeholder="78" step="0.1">
            </div>

            <div class="form-group">
                <label class="form-label">Date cible</label>
                <input type="date" class="form-input" id="weightGoalDate">
            </div>

            <div style="display: flex; gap: 12px;">
                <button class="btn btn-secondary" onclick="clearWeightGoal()" style="flex: 1;">Supprimer</button>
                <button class="btn btn-primary" onclick="saveWeightGoal()" style="flex: 1;">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Weight Entry Modal -->
    <div class="modal" id="weightEntryModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Nouvelle pes√©e</span>
                <button class="modal-close" onclick="closeWeightEntryModal()">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">Poids (kg)</label>
                <input type="number" class="form-input" id="weightEntryValue" placeholder="84.5" step="0.1">
            </div>

            <div class="form-group">
                <label class="form-label">Date</label>
                <input type="date" class="form-input" id="weightEntryDate">
            </div>

            <button class="btn btn-success" onclick="addWeightEntry()">Enregistrer</button>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="nav">
        <button class="nav-item active" data-page="homePage" onclick="showPage('homePage')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            <span>Accueil</span>
        </button>
        <button class="nav-item" data-page="workoutPage" onclick="showPage('workoutPage')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6.5 6.5h11M6.5 17.5h11M4 12h16M8 6.5v11M16 6.5v11"></path>
            </svg>
            <span>S√©ance</span>
        </button>
        <button class="nav-item" data-page="statsPage" onclick="showPage('statsPage')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
            </svg>
            <span>Stats</span>
        </button>
        <button class="nav-item" data-page="settingsPage" onclick="showPage('settingsPage')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
            <span>R√©glages</span>
        </button>
    </nav>

    <script>
        // ==================== PROGRAMMES ====================
        const PROGRAMS = {
            force: {
                id: 'force',
                name: 'Force',
                icon: 'üî•',
                description: 'Charges lourdes, 4-6 reps',
                gradient: 'force',
                restTime: 120,
                workouts: {
                    upperA: {
                        id: 'upperA', name: 'Upper A - Force Push',
                        exercises: [
                            { id: 'bench', name: 'D√©velopp√© couch√©', variants: ['D√©velopp√© couch√©', 'D√©velopp√© inclin√©', 'Floor press'], sets: 5, reps: '4-6', defaultWeight: 70 },
                            { id: 'row', name: 'Rowing barre', variants: ['Rowing barre', 'Rowing Pendlay', 'Rowing T-bar'], sets: 5, reps: '4-6', defaultWeight: 60 },
                            { id: 'ohp', name: 'D√©velopp√© militaire', variants: ['D√©velopp√© militaire', 'Push press', 'D√©velopp√© halt√®res'], sets: 4, reps: '5-6', defaultWeight: 45 },
                            { id: 'arms', name: 'Curl barre + Dips', sets: 3, reps: '6-8', defaultWeight: 30, biset: { id: 'dips', name: 'Dips lest√©s', sets: 3, reps: '6-8', defaultWeight: 10 } }
                        ]
                    },
                    upperB: {
                        id: 'upperB', name: 'Upper B - Force Pull',
                        exercises: [
                            { id: 'pullups', name: 'Tractions lest√©es', variants: ['Tractions pronation', 'Tractions supination', 'Tractions neutres'], sets: 5, reps: '4-6', defaultWeight: 10 },
                            { id: 'incline', name: 'D√©velopp√© inclin√©', variants: ['D√©velopp√© inclin√© barre', 'D√©velopp√© inclin√© halt√®res'], sets: 4, reps: '5-6', defaultWeight: 55 },
                            { id: 'dbrow', name: 'Rowing halt√®re lourd', sets: 4, reps: '5-6', defaultWeight: 36 },
                            { id: 'face', name: 'Face pull + Extension triceps', sets: 3, reps: '8-10', defaultWeight: 0, biset: { id: 'tricep', name: 'Barre au front', sets: 3, reps: '6-8', defaultWeight: 25 } }
                        ]
                    },
                    lowerA: {
                        id: 'lowerA', name: 'Lower A - Force Squat',
                        exercises: [
                            { id: 'squat', name: 'Squat barre', variants: ['Squat barre', 'Squat pause', 'Squat avant'], sets: 5, reps: '4-6', defaultWeight: 90 },
                            { id: 'rdl', name: 'Soulev√© roumain', sets: 4, reps: '5-6', defaultWeight: 70 },
                            { id: 'legpress', name: 'Presse √† cuisses / Hack squat', sets: 4, reps: '6-8', defaultWeight: 100 },
                            { id: 'calf', name: 'Mollets debout', sets: 4, reps: '8-10', defaultWeight: 50 }
                        ]
                    },
                    lowerB: {
                        id: 'lowerB', name: 'Lower B - Force Deadlift',
                        exercises: [
                            { id: 'deadlift', name: 'Soulev√© de terre', variants: ['Soulev√© conventionnel', 'Soulev√© sumo', 'Trap bar deadlift'], sets: 5, reps: '3-5', defaultWeight: 110 },
                            { id: 'frontsquat', name: 'Squat avant', sets: 4, reps: '5-6', defaultWeight: 60 },
                            { id: 'bulgare', name: 'Squat bulgare', sets: 3, reps: '6-8', defaultWeight: 20 },
                            { id: 'calfseated', name: 'Mollets assis', sets: 4, reps: '10-12', defaultWeight: 30 }
                        ]
                    }
                }
            },
            volume: {
                id: 'volume',
                name: 'Volume',
                icon: 'üí™',
                description: 'Hypertrophie, 10-15 reps',
                gradient: 'volume',
                restTime: 60,
                workouts: {
                    upperA: {
                        id: 'upperA', name: 'Upper A - Volume Push',
                        exercises: [
                            { id: 'bench', name: 'D√©velopp√© couch√©', variants: ['D√©velopp√© couch√©', 'D√©velopp√© halt√®res', 'D√©velopp√© inclin√© halt√®res'], sets: 4, reps: '10-12', defaultWeight: 50, biset: { id: 'row', name: 'Rowing barre', variants: ['Rowing barre', 'Rowing halt√®res'], sets: 4, reps: '10-12', defaultWeight: 40 } },
                            { id: 'ohp', name: '√âl√©vations lat√©rales', variants: ['√âl√©vations lat√©rales', '√âl√©vations frontales', 'Oiseau'], sets: 4, reps: '12-15', defaultWeight: 8, biset: { id: 'rear', name: 'Oiseau', sets: 4, reps: '12-15', defaultWeight: 6 } },
                            { id: 'cable', name: '√âcart√© poulie / halt√®res', sets: 3, reps: '12-15', defaultWeight: 10, biset: { id: 'face', name: 'Face pull', sets: 3, reps: '15-20', defaultWeight: 0 } },
                            { id: 'arms', name: 'Curl inclin√© + Extension corde', sets: 3, reps: '12-15', defaultWeight: 10, biset: { id: 'tricep', name: 'Pushdown corde', sets: 3, reps: '12-15', defaultWeight: 15 } }
                        ]
                    },
                    upperB: {
                        id: 'upperB', name: 'Upper B - Volume Pull',
                        exercises: [
                            { id: 'pullups', name: 'Tractions', variants: ['Tractions', 'Tirage vertical', 'Tirage neutre'], sets: 4, reps: '8-12', defaultWeight: 0, biset: { id: 'push', name: 'D√©velopp√© inclin√©', sets: 4, reps: '10-12', defaultWeight: 40 } },
                            { id: 'dbrow', name: 'Rowing halt√®re', sets: 4, reps: '10-12', defaultWeight: 24, biset: { id: 'flyes', name: '√âcart√© couch√©', sets: 4, reps: '12-15', defaultWeight: 10 } },
                            { id: 'shrug', name: 'Shrugs + D√©velopp√© Arnold', sets: 3, reps: '12-15', defaultWeight: 30, biset: { id: 'arnold', name: 'D√©velopp√© Arnold', sets: 3, reps: '10-12', defaultWeight: 14 } },
                            { id: 'curl', name: 'Curl marteau + Kickback', sets: 3, reps: '12-15', defaultWeight: 12, biset: { id: 'kick', name: 'Kickback triceps', sets: 3, reps: '12-15', defaultWeight: 8 } }
                        ]
                    },
                    lowerA: {
                        id: 'lowerA', name: 'Lower A - Volume Quad',
                        exercises: [
                            { id: 'squat', name: 'Squat barre', variants: ['Squat barre', 'Goblet squat', 'Squat hack'], sets: 4, reps: '10-12', defaultWeight: 60 },
                            { id: 'lunge', name: 'Fentes march√©es', variants: ['Fentes march√©es', 'Fentes arri√®re', 'Fentes lat√©rales'], sets: 4, reps: '12/jambe', defaultWeight: 16, biset: { id: 'legcurl', name: 'Leg curl', sets: 4, reps: '12-15', defaultWeight: 0 } },
                            { id: 'ext', name: 'Extension quadriceps', sets: 3, reps: '12-15', defaultWeight: 30, biset: { id: 'hip', name: 'Hip thrust', sets: 3, reps: '12-15', defaultWeight: 60 } },
                            { id: 'calf', name: 'Mollets debout + assis', sets: 4, reps: '15-20', defaultWeight: 30, biset: { id: 'calfs', name: 'Mollets assis', sets: 4, reps: '15-20', defaultWeight: 20 } }
                        ]
                    },
                    lowerB: {
                        id: 'lowerB', name: 'Lower B - Volume Post.',
                        exercises: [
                            { id: 'rdl', name: 'Soulev√© roumain', variants: ['Soulev√© roumain', 'Soulev√© jambes tendues', 'Good morning'], sets: 4, reps: '10-12', defaultWeight: 50 },
                            { id: 'bulgare', name: 'Squat bulgare', sets: 4, reps: '10-12/jambe', defaultWeight: 14, biset: { id: 'bridge', name: 'Pont fessier unilat√©ral', sets: 4, reps: '12/jambe', defaultWeight: 0 } },
                            { id: 'sumo', name: 'Sumo squat', sets: 3, reps: '12-15', defaultWeight: 24, biset: { id: 'abduct', name: 'Abducteurs', sets: 3, reps: '15-20', defaultWeight: 0 } },
                            { id: 'calf', name: 'Mollets', sets: 4, reps: '15-20', defaultWeight: 30 }
                        ]
                    }
                }
            },
            mixte: {
                id: 'mixte',
                name: 'Mixte',
                icon: '‚ö°',
                description: 'Polyvalent, 8-12 reps',
                gradient: 'mixte',
                restTime: 90,
                workouts: {
                    upperA: {
                        id: 'upperA', name: 'Upper A - Push',
                        exercises: [
                            { id: 'bench', name: 'D√©velopp√© couch√©', variants: ['D√©velopp√© couch√©', 'D√©velopp√© inclin√©', 'D√©velopp√© halt√®res'], sets: 4, reps: '8-10', defaultWeight: 60, biset: { id: 'row', name: 'Rowing barre', variants: ['Rowing barre', 'Rowing halt√®res'], sets: 4, reps: '8-10', defaultWeight: 50 } },
                            { id: 'ohp', name: 'D√©velopp√© √©paules', variants: ['D√©velopp√© militaire', 'D√©velopp√© halt√®res', 'Arnold press'], sets: 3, reps: '8-10', defaultWeight: 35, biset: { id: 'lateral', name: '√âl√©vations lat√©rales', sets: 3, reps: '12-15', defaultWeight: 8 } },
                            { id: 'dips', name: 'Dips', sets: 3, reps: '10-12', defaultWeight: 0, biset: { id: 'curl', name: 'Curl marteau', sets: 3, reps: '10-12', defaultWeight: 14 } }
                        ]
                    },
                    upperB: {
                        id: 'upperB', name: 'Upper B - Pull',
                        exercises: [
                            { id: 'pullups', name: 'Tractions', variants: ['Tractions pronation', 'Tractions supination', 'Tirage vertical'], sets: 4, reps: '6-10', defaultWeight: 0, biset: { id: 'incline', name: 'D√©velopp√© inclin√©', sets: 4, reps: '8-10', defaultWeight: 45 } },
                            { id: 'dbrow', name: 'Rowing halt√®re', sets: 3, reps: '10-12', defaultWeight: 28, biset: { id: 'face', name: 'Face pull', sets: 3, reps: '15-20', defaultWeight: 0 } },
                            { id: 'curl', name: 'Curl barre', sets: 3, reps: '10-12', defaultWeight: 25, biset: { id: 'tricep', name: 'Extension triceps', sets: 3, reps: '10-12', defaultWeight: 14 } }
                        ]
                    },
                    lowerA: {
                        id: 'lowerA', name: 'Lower A - Quad',
                        exercises: [
                            { id: 'squat', name: 'Squat barre', variants: ['Squat barre', 'Squat avant', 'Squat pause'], sets: 4, reps: '8-10', defaultWeight: 70 },
                            { id: 'lunge', name: 'Fentes', variants: ['Fentes march√©es', 'Fentes arri√®re', 'Fentes bulgares'], sets: 3, reps: '10/jambe', defaultWeight: 16, biset: { id: 'rdl', name: 'Soulev√© roumain', sets: 3, reps: '10-12', defaultWeight: 50 } },
                            { id: 'goblet', name: 'Goblet squat', sets: 3, reps: '12-15', defaultWeight: 24, biset: { id: 'calf', name: 'Mollets', sets: 3, reps: '15-20', defaultWeight: 30 } }
                        ]
                    },
                    lowerB: {
                        id: 'lowerB', name: 'Lower B - Post.',
                        exercises: [
                            { id: 'deadlift', name: 'Soulev√© de terre', variants: ['Soulev√© conventionnel', 'Soulev√© sumo', 'Trap bar'], sets: 4, reps: '6-8', defaultWeight: 90 },
                            { id: 'bulgare', name: 'Squat bulgare', sets: 3, reps: '10/jambe', defaultWeight: 14, biset: { id: 'legcurl', name: 'Leg curl √©lastique', sets: 3, reps: '12-15', defaultWeight: 0 } },
                            { id: 'sumo', name: 'Sumo squat halt√®re', sets: 3, reps: '12-15', defaultWeight: 28, biset: { id: 'calf', name: 'Mollets assis', sets: 3, reps: '15-20', defaultWeight: 25 } }
                        ]
                    }
                }
            },
            fullbody: {
                id: 'fullbody',
                name: 'Full Body',
                icon: 'üéØ',
                description: '3 s√©ances compl√®tes',
                gradient: 'fullbody',
                restTime: 90,
                workouts: {
                    fbA: {
                        id: 'fbA', name: 'Full Body A',
                        exercises: [
                            { id: 'squat', name: 'Squat barre', variants: ['Squat barre', 'Goblet squat', 'Squat avant'], sets: 4, reps: '8-10', defaultWeight: 70 },
                            { id: 'bench', name: 'D√©velopp√© couch√©', variants: ['D√©velopp√© couch√©', 'D√©velopp√© halt√®res'], sets: 4, reps: '8-10', defaultWeight: 55 },
                            { id: 'row', name: 'Rowing barre', variants: ['Rowing barre', 'Rowing halt√®res'], sets: 4, reps: '8-10', defaultWeight: 50 },
                            { id: 'ohp', name: 'D√©velopp√© √©paules', sets: 3, reps: '10-12', defaultWeight: 30 },
                            { id: 'curl', name: 'Curl + Triceps', sets: 3, reps: '10-12', defaultWeight: 12, biset: { id: 'tricep', name: 'Extension triceps', sets: 3, reps: '10-12', defaultWeight: 12 } }
                        ]
                    },
                    fbB: {
                        id: 'fbB', name: 'Full Body B',
                        exercises: [
                            { id: 'deadlift', name: 'Soulev√© de terre', variants: ['Soulev√© conventionnel', 'Soulev√© roumain'], sets: 4, reps: '6-8', defaultWeight: 90 },
                            { id: 'incline', name: 'D√©velopp√© inclin√©', variants: ['D√©velopp√© inclin√© barre', 'D√©velopp√© inclin√© halt√®res'], sets: 4, reps: '8-10', defaultWeight: 45 },
                            { id: 'pullups', name: 'Tractions', sets: 4, reps: '6-10', defaultWeight: 0 },
                            { id: 'lateral', name: '√âl√©vations lat√©rales', sets: 3, reps: '12-15', defaultWeight: 8 },
                            { id: 'lunge', name: 'Fentes + Mollets', sets: 3, reps: '10/jambe', defaultWeight: 16, biset: { id: 'calf', name: 'Mollets', sets: 3, reps: '15-20', defaultWeight: 30 } }
                        ]
                    },
                    fbC: {
                        id: 'fbC', name: 'Full Body C',
                        exercises: [
                            { id: 'frontsquat', name: 'Squat avant / Goblet', variants: ['Squat avant', 'Goblet squat'], sets: 4, reps: '8-10', defaultWeight: 50 },
                            { id: 'dips', name: 'Dips', sets: 4, reps: '8-12', defaultWeight: 0 },
                            { id: 'dbrow', name: 'Rowing halt√®re', sets: 4, reps: '10-12', defaultWeight: 26 },
                            { id: 'rdl', name: 'Soulev√© roumain', sets: 3, reps: '10-12', defaultWeight: 50 },
                            { id: 'face', name: 'Face pull + Curl marteau', sets: 3, reps: '12-15', defaultWeight: 0, biset: { id: 'hammer', name: 'Curl marteau', sets: 3, reps: '10-12', defaultWeight: 14 } }
                        ]
                    }
                }
            },
            crossfit: {
                id: 'crossfit',
                name: 'CrossFit',
                icon: 'üèãÔ∏è',
                description: 'WOD, Halt√©ro & Gym',
                gradient: 'crossfit',
                restTime: 60,
                workouts: {
                    wod: {
                        id: 'wod', name: 'WOD du jour',
                        exercises: [
                            { id: 'wod1', name: 'WOD', sets: 1, reps: 'AMRAP/For Time', defaultWeight: 0 }
                        ]
                    },
                    haltero: {
                        id: 'haltero', name: 'Halt√©rophilie',
                        exercises: [
                            { id: 'snatch', name: 'Snatch', sets: 5, reps: '3', defaultWeight: 40 },
                            { id: 'clean', name: 'Clean & Jerk', sets: 5, reps: '2', defaultWeight: 50 },
                            { id: 'frontSquat', name: 'Front Squat', sets: 4, reps: '5', defaultWeight: 60 },
                            { id: 'ohSquat', name: 'Overhead Squat', sets: 3, reps: '5', defaultWeight: 30 }
                        ]
                    },
                    gym: {
                        id: 'gym', name: 'Gymnastique',
                        exercises: [
                            { id: 'muscleUp', name: 'Muscle-ups', sets: 5, reps: '3-5', defaultWeight: 0 },
                            { id: 'hspu', name: 'HSPU', sets: 4, reps: '5-8', defaultWeight: 0 },
                            { id: 't2b', name: 'Toes-to-bar', sets: 4, reps: '10-15', defaultWeight: 0 },
                            { id: 'pistol', name: 'Pistol Squats', sets: 3, reps: '8/jambe', defaultWeight: 0 }
                        ]
                    }
                }
            }
        };

        const CROSSFIT_WODS = {
            fran: { name: 'Fran', type: 'fortime', reps: '21-15-9', exercises: ['Thrusters (43/30kg)', 'Pull-ups'], description: '21-15-9 Thrusters + Pull-ups' },
            murph: { name: 'Murph', type: 'fortime', exercises: ['Run 1.6km', '100 Pull-ups', '200 Push-ups', '300 Squats', 'Run 1.6km'], description: 'Le WOD Hero par excellence' },
            cindy: { name: 'Cindy', type: 'amrap', duration: 20, exercises: ['5 Pull-ups', '10 Push-ups', '15 Squats'], description: 'AMRAP 20 min' },
            helen: { name: 'Helen', type: 'fortime', rounds: 3, exercises: ['Run 400m', '21 KB Swings (24/16kg)', '12 Pull-ups'], description: '3 rounds For Time' },
            grace: { name: 'Grace', type: 'fortime', exercises: ['30 Clean & Jerk (60/43kg)'], description: '30 Clean & Jerk For Time' },
            isabel: { name: 'Isabel', type: 'fortime', exercises: ['30 Snatch (60/43kg)'], description: '30 Snatch For Time' },
            diane: { name: 'Diane', type: 'fortime', reps: '21-15-9', exercises: ['Deadlift (100/70kg)', 'HSPU'], description: '21-15-9 DL + HSPU' },
            annie: { name: 'Annie', type: 'fortime', reps: '50-40-30-20-10', exercises: ['Double-unders', 'Sit-ups'], description: '50-40-30-20-10' },
            jackie: { name: 'Jackie', type: 'fortime', exercises: ['1km Row', '50 Thrusters (20/15kg)', '30 Pull-ups'], description: 'Row + Thrusters + Pull-ups' },
            karen: { name: 'Karen', type: 'fortime', exercises: ['150 Wall Balls (9/6kg)'], description: '150 Wall Balls For Time' },
            nancy: { name: 'Nancy', type: 'fortime', rounds: 5, exercises: ['Run 400m', '15 Overhead Squat (43/30kg)'], description: '5 rounds' },
            chelsea: { name: 'Chelsea', type: 'emom', duration: 30, exercises: ['5 Pull-ups', '10 Push-ups', '15 Squats'], description: 'EMOM 30 min' },
            amanda: { name: 'Amanda', type: 'fortime', reps: '9-7-5', exercises: ['Muscle-ups', 'Snatch (60/43kg)'], description: '9-7-5 MU + Snatch' },
            elizabeth: { name: 'Elizabeth', type: 'fortime', reps: '21-15-9', exercises: ['Clean (60/43kg)', 'Ring Dips'], description: '21-15-9' },
            filthy50: { name: 'Filthy 50', type: 'fortime', exercises: ['50 Box Jumps', '50 Jumping Pull-ups', '50 KB Swings', '50 Walking Lunges', '50 K2E', '50 Push Press', '50 Back Extensions', '50 Wall Balls', '50 Burpees', '50 Double-unders'], description: '50 reps de 10 exercices' }
        };

        const BODYWEIGHT_EXERCISES = {
            'D√©velopp√© couch√©': 'Pompes',
            'D√©velopp√© inclin√©': 'Pompes d√©clin√©es',
            'D√©velopp√© halt√®res': 'Pompes larges',
            'Floor press': 'Pompes serr√©es',
            'Rowing barre': 'Rowing invers√© (table)',
            'Rowing halt√®res': 'Rowing serviette',
            'Tractions': 'Tractions porte',
            'Tractions pronation': 'Tractions porte',
            'Tractions supination': 'Chin-ups porte',
            'D√©velopp√© militaire': 'Pike push-ups',
            'D√©velopp√© √©paules': 'Pike push-ups',
            '√âl√©vations lat√©rales': 'Cercles de bras',
            'Dips': 'Dips sur chaise',
            'Dips lest√©s': 'Dips sur chaise',
            'Curl barre': 'Curl serviette',
            'Curl marteau': 'Curl isom√©trique',
            'Extension triceps': 'Diamond push-ups',
            'Squat barre': 'Squats saut√©s',
            'Squat avant': 'Sissy squat',
            'Goblet squat': 'Squat sumo PDC',
            'Fentes': 'Fentes altern√©es',
            'Fentes march√©es': 'Fentes saut√©es',
            'Squat bulgare': 'Squat bulgare PDC',
            'Soulev√© de terre': 'Soulev√© unipodal PDC',
            'Soulev√© roumain': 'Good morning PDC',
            'Hip thrust': 'Pont fessier',
            'Mollets': 'Mollets sur marche',
            'default': 'Exercice au poids de corps'
        };

        // ==================== EXERCISE DETAILS (Descriptions FR + Images) ====================
        const EXERCISE_DETAILS = {
            // ========== HAUT DU CORPS - PECTORAUX ==========
            'D√©velopp√© couch√©': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Bench_Press_-_Medium_Grip/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Bench_Press_-_Medium_Grip/1.jpg',
                execution: [
                    "Allongez-vous sur le banc, pieds fermement au sol",
                    "Saisissez la barre l√©g√®rement plus large que les √©paules",
                    "Descendez la barre de fa√ßon contr√¥l√©e jusqu'au milieu de la poitrine",
                    "Poussez en expirant jusqu'√† l'extension compl√®te des bras"
                ],
                vigilance: [
                    "Gardez les omoplates serr√©es et le dos l√©g√®rement cambr√©",
                    "Ne rebondissez jamais la barre sur la poitrine",
                    "Coudes √† 45¬∞ du corps (pas √† 90¬∞ pour prot√©ger les √©paules)",
                    "Poignets droits et verrouill√©s, ne les cassez pas en arri√®re"
                ],
                muscles: { principaux: ["Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs", "Triceps"] }
            },
            'D√©velopp√© inclin√©': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Incline_Bench_Press_-_Medium_Grip/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Incline_Bench_Press_-_Medium_Grip/1.jpg',
                execution: [
                    "R√©glez le banc √† 30-45¬∞ d'inclinaison",
                    "Saisissez la barre largeur d'√©paules ou l√©g√®rement plus",
                    "Descendez vers le haut de la poitrine (clavicules)",
                    "Poussez en ligne droite vers le plafond"
                ],
                vigilance: [
                    "Ne descendez pas trop bas pour √©viter le stress sur l'√©paule",
                    "Gardez le bas du dos plaqu√© contre le banc",
                    "√âvitez d'incliner trop haut (>45¬∞) ce qui sollicite trop les √©paules",
                    "Contractez les abdos pour stabiliser le tronc"
                ],
                muscles: { principaux: ["Pectoraux sup√©rieurs"], secondaires: ["Delto√Ødes ant√©rieurs", "Triceps"] }
            },
            'D√©velopp√© halt√®res': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Bench_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Bench_Press/1.jpg',
                execution: [
                    "Allongez-vous avec un halt√®re dans chaque main",
                    "D√©marrez bras tendus au-dessus de la poitrine",
                    "Descendez en √©cartant les coudes √† 45¬∞",
                    "Remontez en rapprochant l√©g√®rement les halt√®res"
                ],
                vigilance: [
                    "Contr√¥lez la descente, ne laissez pas tomber les halt√®res",
                    "Gardez les poignets neutres (pas de rotation excessive)",
                    "Ne descendez pas plus bas que le niveau du banc",
                    "√Ä la fin, ramenez les halt√®res sur les cuisses avant de vous relever"
                ],
                muscles: { principaux: ["Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs", "Triceps"] }
            },
            'Floor press': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternating_Floor_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternating_Floor_Press/1.jpg',
                execution: [
                    "Allongez-vous au sol, genoux fl√©chis, pieds √† plat",
                    "Saisissez la barre ou les halt√®res",
                    "Descendez jusqu'√† ce que les coudes touchent le sol",
                    "Marquez une pause puis poussez vers le haut"
                ],
                vigilance: [
                    "Le sol limite naturellement l'amplitude - respectez-la",
                    "Gardez les coudes √† 45¬∞ du corps",
                    "Ne rebondissez pas les coudes sur le sol",
                    "Id√©al pour travailler le lockout et prot√©ger les √©paules"
                ],
                muscles: { principaux: ["Pectoraux", "Triceps"], secondaires: ["Delto√Ødes ant√©rieurs"] }
            },
            '√âcart√© poulie / halt√®res': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Flyes/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Flyes/1.jpg',
                execution: [
                    "Allongez-vous sur le banc, halt√®res au-dessus de la poitrine",
                    "Bras l√©g√®rement fl√©chis, paumes face √† face",
                    "Ouvrez les bras en arc de cercle jusqu'√† sentir l'√©tirement",
                    "Remontez en serrant les pectoraux"
                ],
                vigilance: [
                    "Gardez toujours une l√©g√®re flexion des coudes",
                    "Ne descendez pas trop bas pour prot√©ger les √©paules",
                    "Mouvement lent et contr√¥l√©, pas d'√©lan",
                    "Concentrez-vous sur la contraction des pectoraux"
                ],
                muscles: { principaux: ["Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs"] }
            },
            '√âcart√© couch√©': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Flyes/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Flyes/1.jpg',
                execution: [
                    "Allongez-vous sur le banc, halt√®res au-dessus de la poitrine",
                    "Bras l√©g√®rement fl√©chis, paumes face √† face",
                    "Ouvrez les bras en arc de cercle jusqu'√† sentir l'√©tirement",
                    "Remontez en serrant les pectoraux"
                ],
                vigilance: [
                    "Gardez toujours une l√©g√®re flexion des coudes",
                    "Ne descendez pas trop bas pour prot√©ger les √©paules",
                    "Mouvement lent et contr√¥l√©, pas d'√©lan",
                    "Concentrez-vous sur la contraction des pectoraux"
                ],
                muscles: { principaux: ["Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs"] }
            },

            // ========== HAUT DU CORPS - DOS ==========
            'Rowing barre': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Barbell_Row/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Barbell_Row/1.jpg',
                execution: [
                    "Debout, pieds largeur d'√©paules, genoux l√©g√®rement fl√©chis",
                    "Penchez le buste √† 45¬∞ environ, dos droit",
                    "Tirez la barre vers le nombril en serrant les omoplates",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Gardez le dos droit et neutre pendant tout le mouvement",
                    "Ne tirez pas avec les biceps, concentrez-vous sur les dorsaux",
                    "√âvitez de vous redresser pour tricher",
                    "Serrez les omoplates en haut du mouvement"
                ],
                muscles: { principaux: ["Dorsaux", "Trap√®zes"], secondaires: ["Biceps", "Rhombo√Ødes", "Lombaires"] }
            },
            'Rowing Pendlay': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Barbell_Row/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Barbell_Row/1.jpg',
                execution: [
                    "Buste parall√®le au sol, barre au sol",
                    "Tirez explosif la barre vers le bas de la poitrine",
                    "Reposez compl√®tement la barre au sol entre chaque rep",
                    "Gardez le dos parfaitement horizontal"
                ],
                vigilance: [
                    "Buste strictement parall√®le au sol",
                    "Chaque r√©p√©tition part du sol (dead stop)",
                    "Mouvement explosif mais contr√¥l√©",
                    "√âvitez tout mouvement de balancier du corps"
                ],
                muscles: { principaux: ["Dorsaux", "Trap√®zes"], secondaires: ["Biceps", "Rhombo√Ødes", "√ârecteurs"] }
            },
            'Rowing halt√®re': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Two-Dumbbell_Row/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Two-Dumbbell_Row/1.jpg',
                execution: [
                    "Un genou et une main sur le banc, dos parall√®le au sol",
                    "Halt√®re dans l'autre main, bras tendu vers le sol",
                    "Tirez l'halt√®re vers la hanche en gardant le coude proche du corps",
                    "Redescendez lentement en √©tirant le dorsal"
                ],
                vigilance: [
                    "Gardez le dos droit et parall√®le au sol",
                    "Ne tournez pas le torse pendant le mouvement",
                    "Tirez vers la hanche, pas vers l'√©paule",
                    "Contr√¥lez la phase n√©gative (descente)"
                ],
                muscles: { principaux: ["Dorsaux"], secondaires: ["Biceps", "Rhombo√Ødes", "Trap√®zes"] }
            },
            'Rowing halt√®re lourd': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Two-Dumbbell_Row/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Two-Dumbbell_Row/1.jpg',
                execution: [
                    "Un genou et une main sur le banc, dos parall√®le au sol",
                    "Halt√®re lourd dans l'autre main, bras tendu",
                    "Tirez puissamment vers la hanche",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Gardez le dos droit malgr√© la charge lourde",
                    "Un l√©ger mouvement du corps est acceptable pour les charges lourdes",
                    "Concentrez-vous sur la contraction du dorsal",
                    "Ne sacrifiez pas la forme pour la charge"
                ],
                muscles: { principaux: ["Dorsaux"], secondaires: ["Biceps", "Rhombo√Ødes", "Trap√®zes"] }
            },
            'Tractions': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/1.jpg',
                execution: [
                    "Suspendez-vous √† la barre, prise l√©g√®rement plus large que les √©paules",
                    "Tirez-vous vers le haut jusqu'√† amener le menton au-dessus de la barre",
                    "Serrez les omoplates et contractez les dorsaux",
                    "Redescendez de fa√ßon contr√¥l√©e jusqu'√† l'extension compl√®te"
                ],
                vigilance: [
                    "√âvitez de vous balancer ou d'utiliser l'√©lan",
                    "Initiez le mouvement par les dorsaux, pas les biceps",
                    "Descendez compl√®tement pour √©tirer les dorsaux",
                    "Gardez les √©paules basses et en arri√®re"
                ],
                muscles: { principaux: ["Dorsaux", "Grand rond"], secondaires: ["Biceps", "Trap√®zes", "Rhombo√Ødes"] }
            },
            'Tractions lest√©es': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/1.jpg',
                execution: [
                    "Attachez le poids √† une ceinture de lest",
                    "Suspendez-vous, prise pronation largeur d'√©paules",
                    "Tirez-vous en gardant le contr√¥le malgr√© la charge",
                    "Redescendez lentement sans rebond"
                ],
                vigilance: [
                    "Commencez avec un poids l√©ger et progressez graduellement",
                    "Le lest ne doit pas compromettre la technique",
                    "Gardez le corps gain√© pour √©viter le balancement",
                    "Descendez compl√®tement entre chaque r√©p√©tition"
                ],
                muscles: { principaux: ["Dorsaux", "Grand rond"], secondaires: ["Biceps", "Trap√®zes"] }
            },
            'Tractions pronation': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/1.jpg',
                execution: [
                    "Prise en pronation (paumes vers l'avant), plus large que les √©paules",
                    "Tirez-vous jusqu'√† ce que le menton d√©passe la barre",
                    "Serrez fort les omoplates en haut",
                    "Redescendez compl√®tement bras tendus"
                ],
                vigilance: [
                    "Prise pronation = plus de travail sur la largeur du dos",
                    "Ne croisez pas les jambes, gardez-les l√©g√®rement devant",
                    "√âvitez le kipping (balancement)",
                    "Amplitude compl√®te √† chaque r√©p√©tition"
                ],
                muscles: { principaux: ["Dorsaux"], secondaires: ["Biceps", "Trap√®zes", "Avant-bras"] }
            },
            'Tractions supination': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Chin-Up/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Chin-Up/1.jpg',
                execution: [
                    "Prise en supination (paumes vers vous), largeur d'√©paules",
                    "Tirez-vous jusqu'√† ce que le menton d√©passe la barre",
                    "Contractez les biceps et les dorsaux",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Plus facile que la pronation gr√¢ce √† l'implication des biceps",
                    "Gardez les coudes proches du corps",
                    "Ne vous balancez pas pour tricher",
                    "Descendez jusqu'√† l'extension compl√®te"
                ],
                muscles: { principaux: ["Dorsaux", "Biceps"], secondaires: ["Trap√®zes", "Avant-bras"] }
            },
            'Tirage vertical': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Wide-Grip_Lat_Pulldown/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Wide-Grip_Lat_Pulldown/1.jpg',
                execution: [
                    "Asseyez-vous, cuisses cal√©es sous les boudins",
                    "Saisissez la barre large, prise pronation",
                    "Tirez la barre vers le haut de la poitrine",
                    "Remontez de fa√ßon contr√¥l√©e en √©tirant les dorsaux"
                ],
                vigilance: [
                    "Ne tirez pas derri√®re la nuque (risque pour les √©paules)",
                    "Gardez le buste l√©g√®rement inclin√© en arri√®re",
                    "Serrez les omoplates √† chaque r√©p√©tition",
                    "Ne vous penchez pas excessivement en arri√®re"
                ],
                muscles: { principaux: ["Dorsaux"], secondaires: ["Biceps", "Trap√®zes", "Rhombo√Ødes"] }
            },
            'Face pull': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Face_Pull/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Face_Pull/1.jpg',
                execution: [
                    "Face √† la poulie haute, corde √† hauteur du visage",
                    "Tirez la corde vers le visage en √©cartant les mains",
                    "Serrez les omoplates et tournez les pouces vers l'arri√®re",
                    "Revenez lentement √† la position de d√©part"
                ],
                vigilance: [
                    "Gardez les coudes hauts pendant tout le mouvement",
                    "Ne tirez pas avec les bras, utilisez les √©paules arri√®re",
                    "Mouvement lent et contr√¥l√©",
                    "Excellent pour la sant√© des √©paules - √† faire r√©guli√®rement"
                ],
                muscles: { principaux: ["Delto√Ødes post√©rieurs", "Trap√®zes"], secondaires: ["Rhombo√Ødes", "Rotateurs externes"] }
            },
            'Shrugs': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shrug/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shrug/1.jpg',
                execution: [
                    "Debout, barre ou halt√®res le long du corps",
                    "Montez les √©paules vers les oreilles",
                    "Maintenez la contraction 1-2 secondes en haut",
                    "Redescendez lentement"
                ],
                vigilance: [
                    "Ne roulez pas les √©paules (mouvement vertical uniquement)",
                    "Gardez les bras tendus, ne pliez pas les coudes",
                    "Ne penchez pas la t√™te en avant",
                    "Utilisez une charge permettant une amplitude compl√®te"
                ],
                muscles: { principaux: ["Trap√®zes sup√©rieurs"], secondaires: ["Rhombo√Ødes", "√âl√©vateur de la scapula"] }
            },

            // ========== HAUT DU CORPS - √âPAULES ==========
            'D√©velopp√© militaire': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shoulder_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shoulder_Press/1.jpg',
                execution: [
                    "Debout ou assis, barre au niveau des clavicules",
                    "Poussez la barre au-dessus de la t√™te jusqu'√† l'extension",
                    "La barre passe devant le visage puis monte verticalement",
                    "Redescendez de fa√ßon contr√¥l√©e aux clavicules"
                ],
                vigilance: [
                    "Gardez le tronc gain√©, √©vitez de cambrer le dos",
                    "Ne verrouillez pas brutalement les coudes en haut",
                    "Rentrez l√©g√®rement le menton pour laisser passer la barre",
                    "Ne descendez pas plus bas que les clavicules"
                ],
                muscles: { principaux: ["Delto√Ødes"], secondaires: ["Triceps", "Trap√®zes sup√©rieurs"] }
            },
            'D√©velopp√© √©paules': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shoulder_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Shoulder_Press/1.jpg',
                execution: [
                    "Assis ou debout, halt√®res ou barre au niveau des √©paules",
                    "Poussez vers le haut jusqu'√† l'extension des bras",
                    "Gardez le corps stable et gain√©",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Ne cambrez pas excessivement le dos",
                    "Gardez les abdos contract√©s",
                    "Coudes l√©g√®rement devant le corps, pas sur les c√¥t√©s",
                    "Contr√¥lez la descente"
                ],
                muscles: { principaux: ["Delto√Ødes"], secondaires: ["Triceps", "Trap√®zes"] }
            },
            'Push press': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Push_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Push_Press/1.jpg',
                execution: [
                    "Barre aux clavicules, pieds largeur d'√©paules",
                    "Fl√©chissez l√©g√®rement les genoux (dip)",
                    "Poussez explosif avec les jambes puis les bras",
                    "Verrouillez les bras en haut, redescendez contr√¥l√©"
                ],
                vigilance: [
                    "Le dip doit √™tre court et contr√¥l√© (10-15cm)",
                    "L'√©lan vient des jambes, pas du dos",
                    "Gardez le tronc gain√© pendant tout le mouvement",
                    "Ne penchez pas en arri√®re"
                ],
                muscles: { principaux: ["Delto√Ødes", "Quadriceps"], secondaires: ["Triceps", "Trap√®zes", "Core"] }
            },
            'D√©velopp√© Arnold': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Arnold_Dumbbell_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Arnold_Dumbbell_Press/1.jpg',
                execution: [
                    "Assis, halt√®res devant les √©paules, paumes vers vous",
                    "Poussez en tournant les paumes vers l'avant",
                    "Terminez bras tendus, paumes vers l'avant",
                    "Redescendez en inversant la rotation"
                ],
                vigilance: [
                    "La rotation doit √™tre fluide et continue",
                    "Ne forcez pas la rotation en bas du mouvement",
                    "Gardez le dos bien droit contre le dossier",
                    "Mouvement lent et contr√¥l√©"
                ],
                muscles: { principaux: ["Delto√Ødes (3 faisceaux)"], secondaires: ["Triceps", "Trap√®zes"] }
            },
            '√âl√©vations lat√©rales': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Side_Lateral_Raise/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Side_Lateral_Raise/1.jpg',
                execution: [
                    "Debout, halt√®res le long du corps",
                    "Levez les bras sur les c√¥t√©s jusqu'√† l'horizontale",
                    "Gardez une l√©g√®re flexion des coudes",
                    "Redescendez lentement sans toucher les cuisses"
                ],
                vigilance: [
                    "Ne montez pas plus haut que les √©paules",
                    "√âvitez de balancer le corps pour tricher",
                    "Gardez les pouces l√©g√®rement vers le bas (versez l'eau)",
                    "Charge l√©g√®re avec bonne forme > charge lourde avec √©lan"
                ],
                muscles: { principaux: ["Delto√Ødes lat√©raux"], secondaires: ["Trap√®zes sup√©rieurs"] }
            },
            '√âl√©vations frontales': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Dumbbell_Raise/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Dumbbell_Raise/1.jpg',
                execution: [
                    "Debout, halt√®res devant les cuisses",
                    "Levez un bras ou les deux devant vous jusqu'√† l'horizontale",
                    "Gardez le bras l√©g√®rement fl√©chi",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Ne montez pas plus haut que les √©paules",
                    "Gardez le corps stable, pas de balancement",
                    "Ne cambrez pas le dos",
                    "Mouvement lent et contr√¥l√©"
                ],
                muscles: { principaux: ["Delto√Ødes ant√©rieurs"], secondaires: ["Pectoraux sup√©rieurs", "Trap√®zes"] }
            },
            'Oiseau': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Dumbbell_Rear_Delt_Raise_With_Head_On_Bench/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bent_Over_Dumbbell_Rear_Delt_Raise_With_Head_On_Bench/1.jpg',
                execution: [
                    "Pench√© √† 90¬∞, halt√®res sous la poitrine",
                    "Levez les bras sur les c√¥t√©s en gardant les coudes l√©g√®rement fl√©chis",
                    "Serrez les omoplates en haut du mouvement",
                    "Redescendez lentement"
                ],
                vigilance: [
                    "Gardez le dos droit et parall√®le au sol",
                    "Ne levez pas le buste pendant le mouvement",
                    "Concentrez-vous sur les delto√Ødes post√©rieurs",
                    "Charge l√©g√®re pour bien sentir le muscle"
                ],
                muscles: { principaux: ["Delto√Ødes post√©rieurs"], secondaires: ["Trap√®zes", "Rhombo√Ødes"] }
            },

            // ========== HAUT DU CORPS - BRAS ==========
            'Curl barre': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/1.jpg',
                execution: [
                    "Debout, barre en prise supination (paumes vers le haut)",
                    "Coudes fixes le long du corps",
                    "Fl√©chissez les bras en montant la barre vers les √©paules",
                    "Redescendez de fa√ßon contr√¥l√©e jusqu'√† l'extension"
                ],
                vigilance: [
                    "Gardez les coudes immobiles le long du corps",
                    "Ne balancez pas le corps pour soulever la charge",
                    "Contr√¥lez la phase n√©gative (descente)",
                    "Ne cambrez pas le dos"
                ],
                muscles: { principaux: ["Biceps"], secondaires: ["Brachial", "Avant-bras"] }
            },
            'Curl barre + Dips': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/1.jpg',
                execution: [
                    "Curl : Debout, barre en supination, montez vers les √©paules",
                    "Gardez les coudes fixes le long du corps",
                    "Encha√Ænez directement avec les dips (biset)",
                    "Pas de repos entre les deux exercices"
                ],
                vigilance: [
                    "Gardez les coudes immobiles pendant le curl",
                    "Ne trichez pas avec le dos",
                    "Le biset = fatigue importante, adaptez les charges",
                    "Concentrez-vous sur la qualit√© plut√¥t que la charge"
                ],
                muscles: { principaux: ["Biceps", "Triceps"], secondaires: ["Avant-bras", "Pectoraux"] }
            },
            'Curl marteau': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternate_Hammer_Curl/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternate_Hammer_Curl/1.jpg',
                execution: [
                    "Debout, halt√®res le long du corps, prise neutre (pouces vers le haut)",
                    "Fl√©chissez un bras en gardant la prise neutre",
                    "Montez jusqu'√† la contraction maximale",
                    "Alternez ou faites les deux bras ensemble"
                ],
                vigilance: [
                    "Gardez les coudes fixes le long du corps",
                    "Ne tournez pas les poignets pendant le mouvement",
                    "Contr√¥lez la descente",
                    "La prise neutre sollicite plus le brachial et l'avant-bras"
                ],
                muscles: { principaux: ["Biceps", "Brachial"], secondaires: ["Avant-bras (brachio-radial)"] }
            },
            'Curl inclin√©': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternate_Incline_Dumbbell_Curl/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Alternate_Incline_Dumbbell_Curl/1.jpg',
                execution: [
                    "Assis sur banc inclin√© √† 45-60¬∞, halt√®res bras tendus",
                    "Les bras pendent naturellement derri√®re le corps",
                    "Fl√©chissez en gardant les coudes fixes",
                    "Redescendez compl√®tement pour √©tirer le biceps"
                ],
                vigilance: [
                    "L'inclinaison √©tire le biceps - commencez l√©ger",
                    "Ne balancez pas les bras",
                    "Gardez les √©paules plaqu√©es contre le banc",
                    "Amplitude compl√®te pour maximiser l'√©tirement"
                ],
                muscles: { principaux: ["Biceps (longue portion)"], secondaires: ["Brachial"] }
            },
            'Curl + Triceps': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Curl/1.jpg',
                execution: [
                    "Curl : Montez la barre/halt√®res vers les √©paules",
                    "Gardez les coudes fixes",
                    "Encha√Ænez avec extension triceps (biset)",
                    "Pas de repos entre les deux"
                ],
                vigilance: [
                    "Biset bras = congestion importante",
                    "Adaptez les charges pour le biset",
                    "Ne sacrifiez pas la forme pour la charge",
                    "Hydratez-vous bien"
                ],
                muscles: { principaux: ["Biceps", "Triceps"], secondaires: ["Avant-bras"] }
            },
            'Dips': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dips_-_Triceps_Version/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dips_-_Triceps_Version/1.jpg',
                execution: [
                    "Mains sur les barres parall√®les, bras tendus",
                    "Corps droit (pour triceps) ou pench√© (pour pectoraux)",
                    "Descendez en fl√©chissant les coudes jusqu'√† 90¬∞",
                    "Poussez pour revenir en position haute"
                ],
                vigilance: [
                    "Ne descendez pas trop bas pour prot√©ger les √©paules",
                    "Gardez les coudes proches du corps pour les triceps",
                    "√âcartez les coudes pour cibler les pectoraux",
                    "√âvitez de balancer les jambes"
                ],
                muscles: { principaux: ["Triceps", "Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs"] }
            },
            'Dips lest√©s': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dips_-_Triceps_Version/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dips_-_Triceps_Version/1.jpg',
                execution: [
                    "Attachez le poids √† une ceinture de lest",
                    "M√™me ex√©cution que les dips classiques",
                    "Descendez de fa√ßon contr√¥l√©e",
                    "Poussez puissamment pour remonter"
                ],
                vigilance: [
                    "Ma√Ætrisez les dips au poids de corps avant de lester",
                    "Le lest augmente le stress sur les √©paules",
                    "Ne descendez pas trop bas",
                    "Progressez graduellement en charge"
                ],
                muscles: { principaux: ["Triceps", "Pectoraux"], secondaires: ["Delto√Ødes ant√©rieurs"] }
            },
            'Extension triceps': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_One-Arm_Triceps_Extension/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_One-Arm_Triceps_Extension/1.jpg',
                execution: [
                    "Debout ou assis, halt√®re tenu √† deux mains au-dessus de la t√™te",
                    "Coudes point√©s vers le plafond, fl√©chissez les avant-bras",
                    "Descendez l'halt√®re derri√®re la t√™te",
                    "Remontez en contractant les triceps"
                ],
                vigilance: [
                    "Gardez les coudes fixes et proches de la t√™te",
                    "Ne cambrez pas le dos",
                    "Mouvement contr√¥l√©, pas d'√©lan",
                    "√âtirez bien en bas, contractez fort en haut"
                ],
                muscles: { principaux: ["Triceps (longue portion)"], secondaires: [] }
            },
            'Barre au front': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Triceps_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Triceps_Press/1.jpg',
                execution: [
                    "Allong√© sur le banc, barre au-dessus de la poitrine",
                    "Coudes fixes, descendez la barre vers le front",
                    "Arr√™tez juste avant de toucher le front",
                    "Remontez en contractant les triceps"
                ],
                vigilance: [
                    "Gardez les coudes parfaitement fixes",
                    "Ne descendez pas la barre trop vite",
                    "Commencez l√©ger pour ma√Ætriser le mouvement",
                    "Variante : descendez derri√®re la t√™te pour plus d'√©tirement"
                ],
                muscles: { principaux: ["Triceps"], secondaires: [] }
            },
            'Pushdown corde': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Triceps_Pushdown_-_Rope_Attachment/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Triceps_Pushdown_-_Rope_Attachment/1.jpg',
                execution: [
                    "Face √† la poulie haute, saisissez la corde",
                    "Coudes coll√©s au corps, poussez vers le bas",
                    "En bas, √©cartez les mains pour contracter les triceps",
                    "Remontez de fa√ßon contr√¥l√©e jusqu'√† 90¬∞"
                ],
                vigilance: [
                    "Gardez les coudes strictement immobiles",
                    "Ne vous penchez pas en avant pour tricher",
                    "√âcartez bien les mains en bas du mouvement",
                    "Mouvement lent et contr√¥l√©"
                ],
                muscles: { principaux: ["Triceps"], secondaires: [] }
            },
            'Kickback triceps': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Triceps_Kickback/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Triceps_Kickback/1.jpg',
                execution: [
                    "Pench√©, un bras en appui, coude √† 90¬∞ le long du corps",
                    "Tendez le bras vers l'arri√®re en gardant le coude fixe",
                    "Contractez fort le triceps en haut",
                    "Revenez lentement √† 90¬∞"
                ],
                vigilance: [
                    "Gardez le coude strictement immobile",
                    "Le bras doit √™tre parall√®le au sol",
                    "Charge l√©g√®re pour bien sentir la contraction",
                    "Ne balancez pas l'halt√®re"
                ],
                muscles: { principaux: ["Triceps"], secondaires: [] }
            },

            // ========== BAS DU CORPS - QUADRICEPS ==========
            'Squat barre': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Full_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Full_Squat/1.jpg',
                execution: [
                    "Barre sur les trap√®zes, pieds largeur d'√©paules ou plus",
                    "Pointes de pieds l√©g√®rement vers l'ext√©rieur",
                    "Descendez en poussant les genoux vers l'ext√©rieur",
                    "Descendez jusqu'√† ce que les cuisses soient parall√®les au sol minimum"
                ],
                vigilance: [
                    "Gardez le dos droit et la poitrine sortie",
                    "Les genoux suivent la direction des pieds",
                    "Poussez √† travers les talons pour remonter",
                    "Ne laissez pas les genoux rentrer vers l'int√©rieur"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers", "Lombaires", "Adducteurs"] }
            },
            'Squat avant': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Barbell_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Barbell_Squat/1.jpg',
                execution: [
                    "Barre sur les delto√Ødes ant√©rieurs, coudes hauts",
                    "Pieds largeur d'√©paules, pointes vers l'ext√©rieur",
                    "Descendez en gardant le buste tr√®s droit",
                    "Remontez en gardant les coudes hauts"
                ],
                vigilance: [
                    "Gardez les coudes tr√®s hauts pendant tout le mouvement",
                    "Le buste reste plus vertical qu'au back squat",
                    "Sollicite beaucoup plus les quadriceps",
                    "Travaillez la mobilit√© des poignets si n√©cessaire"
                ],
                muscles: { principaux: ["Quadriceps"], secondaires: ["Fessiers", "Core", "Haut du dos"] }
            },
            'Squat pause': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Full_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Full_Squat/1.jpg',
                execution: [
                    "M√™me position que le squat classique",
                    "Descendez jusqu'en bas",
                    "Marquez une pause de 2-3 secondes en bas",
                    "Remontez explosif"
                ],
                vigilance: [
                    "La pause √©limine l'effet rebond - charge plus l√©g√®re",
                    "Restez gain√© pendant la pause",
                    "Ne rel√¢chez pas la tension en bas",
                    "Excellent pour travailler la force en bas du mouvement"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers", "Core"] }
            },
            'Goblet squat': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Goblet_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Goblet_Squat/1.jpg',
                execution: [
                    "Tenez un halt√®re ou kettlebell contre la poitrine",
                    "Pieds plus larges que les √©paules",
                    "Descendez profond, coudes entre les genoux",
                    "Poussez les genoux vers l'ext√©rieur avec les coudes"
                ],
                vigilance: [
                    "Excellent pour apprendre la technique du squat",
                    "Gardez le poids contre la poitrine, pas devant",
                    "Descendez aussi bas que votre mobilit√© le permet",
                    "Les coudes aident √† ouvrir les hanches"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Core", "Adducteurs"] }
            },
            'Squat bulgare': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Single_Leg_Split_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Single_Leg_Split_Squat/1.jpg',
                execution: [
                    "Pied arri√®re sur un banc, pied avant devant vous",
                    "Descendez jusqu'√† ce que le genou arri√®re fr√¥le le sol",
                    "Le genou avant ne d√©passe pas trop la pointe du pied",
                    "Poussez √† travers le talon avant pour remonter"
                ],
                vigilance: [
                    "Gardez le buste droit pendant tout le mouvement",
                    "Le pied avant assez loin devant pour prot√©ger le genou",
                    "Concentrez l'effort sur la jambe avant",
                    "√âquilibrez les deux c√¥t√©s en termes de r√©p√©titions"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers", "Adducteurs"] }
            },
            'Fentes': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/1.jpg',
                execution: [
                    "Debout, halt√®res le long du corps ou barre sur les √©paules",
                    "Faites un grand pas en avant",
                    "Descendez jusqu'√† ce que le genou arri√®re fr√¥le le sol",
                    "Poussez sur la jambe avant pour revenir"
                ],
                vigilance: [
                    "Gardez le buste droit, ne vous penchez pas en avant",
                    "Le genou avant reste au-dessus de la cheville",
                    "Pas trop court = stress sur le genou",
                    "Pas trop long = perte d'√©quilibre"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers", "Mollets"] }
            },
            'Fentes march√©es': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/1.jpg',
                execution: [
                    "Faites une fente en avan√ßant",
                    "Poussez pour amener le pied arri√®re devant",
                    "Encha√Ænez avec l'autre jambe en continuant d'avancer",
                    "Gardez un rythme r√©gulier"
                ],
                vigilance: [
                    "Gardez le buste droit pendant la marche",
                    "Contr√¥lez chaque pas, ne pr√©cipitez pas",
                    "Regardez devant vous, pas au sol",
                    "Pr√©voyez l'espace n√©cessaire"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers", "Core"] }
            },
            'Presse √† cuisses / Hack squat': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hack_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hack_Squat/1.jpg',
                execution: [
                    "Installez-vous sur la machine, dos bien cal√©",
                    "Pieds √† largeur d'√©paules sur la plateforme",
                    "Descendez en contr√¥lant jusqu'√† 90¬∞ ou plus",
                    "Poussez pour remonter sans verrouiller les genoux"
                ],
                vigilance: [
                    "Ne descendez pas trop bas si vous avez des douleurs lombaires",
                    "Gardez le bas du dos plaqu√© contre le dossier",
                    "Ne verrouillez jamais compl√®tement les genoux",
                    "Position des pieds haute = plus de fessiers, basse = plus de quadriceps"
                ],
                muscles: { principaux: ["Quadriceps"], secondaires: ["Fessiers", "Ischio-jambiers"] }
            },
            'Extension quadriceps': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Leg_Extensions/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Leg_Extensions/1.jpg',
                execution: [
                    "Assis sur la machine, chevilles sous le boudin",
                    "Tendez les jambes jusqu'√† l'extension compl√®te",
                    "Contractez les quadriceps en haut",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Ne donnez pas d'√©lan avec le buste",
                    "Contr√¥lez la descente, ne laissez pas tomber le poids",
                    "√âvitez cet exercice si vous avez des probl√®mes de genoux",
                    "Mouvement d'isolation - pas de charges excessives"
                ],
                muscles: { principaux: ["Quadriceps"], secondaires: [] }
            },

            // ========== BAS DU CORPS - ISCHIO-JAMBIERS / FESSIERS ==========
            'Soulev√© de terre': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Deadlift/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Deadlift/1.jpg',
                execution: [
                    "Pieds largeur de hanches, barre au-dessus des lacets",
                    "Penchez-vous et saisissez la barre, dos droit",
                    "Poussez avec les jambes et levez le buste simultan√©ment",
                    "Terminez debout, hanches et genoux verrouill√©s, √©paules en arri√®re"
                ],
                vigilance: [
                    "Gardez le dos DROIT pendant tout le mouvement",
                    "La barre reste proche du corps (fr√¥le les tibias)",
                    "Ne tirez pas avec le dos, poussez avec les jambes",
                    "Regardez devant vous, pas en l'air"
                ],
                muscles: { principaux: ["Ischio-jambiers", "Fessiers", "Lombaires"], secondaires: ["Quadriceps", "Trap√®zes", "Avant-bras"] }
            },
            'Soulev√© conventionnel': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Deadlift/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Deadlift/1.jpg',
                execution: [
                    "Pieds largeur de hanches, pointes l√©g√®rement vers l'ext√©rieur",
                    "Mains juste √† l'ext√©rieur des genoux",
                    "Dos droit, poitrine sortie, regard devant",
                    "Soulevez en gardant la barre proche du corps"
                ],
                vigilance: [
                    "Le dos reste neutre, jamais arrondi",
                    "La barre monte verticalement le long des jambes",
                    "Contractez les fessiers en haut du mouvement",
                    "Reposez la barre de fa√ßon contr√¥l√©e"
                ],
                muscles: { principaux: ["Ischio-jambiers", "Fessiers", "Lombaires"], secondaires: ["Quadriceps", "Trap√®zes"] }
            },
            'Soulev√© sumo': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Deadlift/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Deadlift/1.jpg',
                execution: [
                    "Pieds tr√®s √©cart√©s, pointes vers l'ext√©rieur (45¬∞+)",
                    "Mains √† l'int√©rieur des genoux, prise √©troite",
                    "Poussez les genoux vers l'ext√©rieur",
                    "Soulevez en gardant le buste plus vertical"
                ],
                vigilance: [
                    "Demande plus de mobilit√© de hanches",
                    "Les genoux doivent suivre les pieds (vers l'ext√©rieur)",
                    "Le buste reste plus droit qu'en conventionnel",
                    "Excellent pour ceux avec un buste long"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers", "Adducteurs"], secondaires: ["Ischio-jambiers", "Lombaires"] }
            },
            'Soulev√© roumain': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Romanian_Deadlift/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Romanian_Deadlift/1.jpg',
                execution: [
                    "Debout, barre en mains, genoux tr√®s l√©g√®rement fl√©chis",
                    "Penchez-vous en poussant les hanches vers l'arri√®re",
                    "Descendez jusqu'√† sentir l'√©tirement des ischio-jambiers",
                    "Remontez en contractant les fessiers"
                ],
                vigilance: [
                    "Gardez le dos DROIT, jamais arrondi",
                    "Le mouvement vient des hanches, pas du dos",
                    "Les genoux restent fixes (l√©g√®rement fl√©chis)",
                    "Ne descendez pas plus bas que votre souplesse le permet"
                ],
                muscles: { principaux: ["Ischio-jambiers", "Fessiers"], secondaires: ["Lombaires"] }
            },
            'Good morning': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Good_Morning/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Good_Morning/1.jpg',
                execution: [
                    "Barre sur les trap√®zes comme pour un squat",
                    "Genoux l√©g√®rement fl√©chis, pieds largeur d'√©paules",
                    "Penchez-vous en poussant les hanches en arri√®re",
                    "Descendez jusqu'√† ce que le buste soit presque parall√®le"
                ],
                vigilance: [
                    "Gardez le dos parfaitement droit",
                    "Commencez tr√®s l√©ger pour ma√Ætriser le mouvement",
                    "Ne descendez pas si vous sentez le dos s'arrondir",
                    "Exercice avanc√© - ma√Ætrisez d'abord le RDL"
                ],
                muscles: { principaux: ["Ischio-jambiers", "Lombaires"], secondaires: ["Fessiers"] }
            },
            'Hip thrust': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/1.jpg',
                execution: [
                    "Dos contre un banc, barre sur les hanches (avec pad)",
                    "Pieds √† plat au sol, √©cart√©s largeur d'√©paules",
                    "Poussez les hanches vers le plafond",
                    "Contractez les fessiers en haut, puis redescendez"
                ],
                vigilance: [
                    "Gardez le menton rentr√© (regardez devant, pas le plafond)",
                    "Ne cambrez pas excessivement le bas du dos",
                    "Contractez fort les fessiers en haut",
                    "Utilisez un pad pour prot√©ger les hanches"
                ],
                muscles: { principaux: ["Fessiers"], secondaires: ["Ischio-jambiers", "Quadriceps"] }
            },
            'Pont fessier unilat√©ral': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Barbell_Hip_Thrust/1.jpg',
                execution: [
                    "Allong√© au sol, un pied au sol, l'autre jambe tendue ou pli√©e en l'air",
                    "Poussez avec le pied au sol pour lever les hanches",
                    "Contractez le fessier en haut",
                    "Redescendez sans toucher le sol entre les r√©p√©titions"
                ],
                vigilance: [
                    "Gardez les hanches parall√®les au sol",
                    "Ne laissez pas la hanche du c√¥t√© libre s'affaisser",
                    "Poussez √† travers le talon",
                    "Travaillez les deux c√¥t√©s de mani√®re √©gale"
                ],
                muscles: { principaux: ["Fessiers"], secondaires: ["Ischio-jambiers", "Core"] }
            },
            'Leg curl': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Leg_Curls/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Leg_Curls/1.jpg',
                execution: [
                    "Allong√© face contre la machine, chevilles sous le boudin",
                    "Fl√©chissez les jambes en amenant les talons vers les fessiers",
                    "Contractez les ischio-jambiers en haut",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Gardez les hanches plaqu√©es contre le banc",
                    "Ne donnez pas d'√©lan avec le bassin",
                    "Contr√¥lez la phase n√©gative",
                    "Ne verrouillez pas les genoux en bas"
                ],
                muscles: { principaux: ["Ischio-jambiers"], secondaires: ["Mollets"] }
            },
            'Leg curl √©lastique': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Leg_Curls/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Lying_Leg_Curls/1.jpg',
                execution: [
                    "Allong√© face au sol, √©lastique autour des chevilles et fix√© devant",
                    "Fl√©chissez les jambes contre la r√©sistance",
                    "Contractez les ischio-jambiers",
                    "Revenez lentement"
                ],
                vigilance: [
                    "Gardez les hanches au sol",
                    "Tension constante de l'√©lastique",
                    "Mouvement contr√¥l√©",
                    "Alternative pratique √† la machine"
                ],
                muscles: { principaux: ["Ischio-jambiers"], secondaires: ["Mollets"] }
            },
            'Sumo squat': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Squat/1.jpg',
                execution: [
                    "Pieds tr√®s √©cart√©s (1.5x largeur d'√©paules), pointes √† 45¬∞",
                    "Halt√®re tenu √† deux mains entre les jambes",
                    "Descendez en gardant le buste droit",
                    "Poussez les genoux vers l'ext√©rieur"
                ],
                vigilance: [
                    "Les genoux suivent la direction des pieds",
                    "Gardez le dos droit, ne vous penchez pas en avant",
                    "Descendez aussi bas que votre mobilit√© le permet",
                    "Excellent pour les adducteurs et l'int√©rieur des cuisses"
                ],
                muscles: { principaux: ["Quadriceps", "Adducteurs", "Fessiers"], secondaires: ["Ischio-jambiers"] }
            },
            'Sumo squat halt√®re': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Sumo_Squat/1.jpg',
                execution: [
                    "Position sumo, halt√®re tenu verticalement entre les jambes",
                    "Descendez en poussant les genoux vers l'ext√©rieur",
                    "Gardez le buste droit",
                    "Poussez √† travers les talons pour remonter"
                ],
                vigilance: [
                    "Ne laissez pas les genoux rentrer vers l'int√©rieur",
                    "Gardez le poids centr√©",
                    "Buste droit tout au long du mouvement",
                    "Amplitude compl√®te si la mobilit√© le permet"
                ],
                muscles: { principaux: ["Quadriceps", "Adducteurs", "Fessiers"], secondaires: ["Ischio-jambiers"] }
            },
            'Abducteurs': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Thigh_Abductor/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Thigh_Abductor/1.jpg',
                execution: [
                    "Assis sur la machine, jambes contre les boudins",
                    "√âcartez les jambes contre la r√©sistance",
                    "Contractez les muscles externes des cuisses",
                    "Revenez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Gardez le dos plaqu√© contre le dossier",
                    "Mouvement contr√¥l√©, pas d'√©lan",
                    "Ne chargez pas excessivement",
                    "Concentrez-vous sur la contraction musculaire"
                ],
                muscles: { principaux: ["Moyen fessier", "Tenseur du fascia lata"], secondaires: [] }
            },

            // ========== BAS DU CORPS - MOLLETS ==========
            'Mollets debout': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/1.jpg',
                execution: [
                    "Debout sur une marche, talons dans le vide",
                    "Descendez les talons pour √©tirer les mollets",
                    "Montez sur la pointe des pieds le plus haut possible",
                    "Contractez fort en haut"
                ],
                vigilance: [
                    "Amplitude maximale (√©tirement + contraction)",
                    "Gardez les jambes tendues (travaille le gastrocn√©mien)",
                    "Mouvement lent et contr√¥l√©",
                    "√âvitez de rebondir"
                ],
                muscles: { principaux: ["Gastrocn√©miens (mollets)"], secondaires: ["Sol√©aire"] }
            },
            'Mollets assis': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Seated_Calf_Raise/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Seated_Calf_Raise/1.jpg',
                execution: [
                    "Assis, genoux sous le boudin, pieds sur la plateforme",
                    "Descendez les talons pour √©tirer",
                    "Montez sur la pointe des pieds",
                    "Contractez en haut puis redescendez"
                ],
                vigilance: [
                    "Genoux pli√©s = cible le sol√©aire",
                    "Amplitude compl√®te obligatoire",
                    "Pas de rebond en bas",
                    "Compl√©mentaire aux mollets debout"
                ],
                muscles: { principaux: ["Sol√©aire"], secondaires: ["Gastrocn√©miens"] }
            },
            'Mollets debout + assis': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/1.jpg',
                execution: [
                    "Alternez entre mollets debout et mollets assis (biset)",
                    "Debout : jambes tendues, cible le gastrocn√©mien",
                    "Assis : genoux pli√©s, cible le sol√©aire",
                    "Encha√Ænez sans repos"
                ],
                vigilance: [
                    "Amplitude compl√®te sur les deux exercices",
                    "Le biset cr√©e une congestion intense",
                    "Adaptez les charges pour le biset",
                    "Les deux exercices sont compl√©mentaires"
                ],
                muscles: { principaux: ["Gastrocn√©miens", "Sol√©aire"], secondaires: [] }
            },
            'Mollets': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Standing_Calf_Raises/1.jpg',
                execution: [
                    "Debout sur une marche ou au sol",
                    "Montez sur la pointe des pieds le plus haut possible",
                    "Contractez les mollets en haut",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Amplitude compl√®te pour un d√©veloppement optimal",
                    "√âvitez les rebonds",
                    "Maintenez la contraction en haut",
                    "Variez debout/assis pour cibler tout le mollet"
                ],
                muscles: { principaux: ["Mollets"], secondaires: [] }
            },

            // ========== CROSSFIT / HALT√âROPHILIE ==========
            'Snatch': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Snatch/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Snatch/1.jpg',
                execution: [
                    "Prise large, barre au sol, dos droit",
                    "Premier tirage : soulevez jusqu'aux genoux",
                    "Deuxi√®me tirage : extension explosive des hanches",
                    "Passez sous la barre et r√©ceptionnez en squat overhead"
                ],
                vigilance: [
                    "Mouvement technique - apprenez avec un coach",
                    "Gardez la barre proche du corps",
                    "L'extension des hanches doit √™tre explosive",
                    "Travaillez la mobilit√© des √©paules avant de charger"
                ],
                muscles: { principaux: ["Corps entier"], secondaires: ["Quadriceps", "Fessiers", "√âpaules", "Dos"] }
            },
            'Clean & Jerk': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Clean_and_Jerk/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Clean_and_Jerk/1.jpg',
                execution: [
                    "Clean : amenez la barre du sol aux √©paules (position front rack)",
                    "Jerk : fl√©chissez l√©g√®rement puis poussez la barre au-dessus de la t√™te",
                    "R√©ceptionnez en split ou en squat",
                    "Terminez debout, barre verrouill√©e au-dessus"
                ],
                vigilance: [
                    "Deux mouvements distincts √† ma√Ætriser s√©par√©ment",
                    "Le clean demande une bonne mobilit√© de poignets",
                    "Le jerk utilise l'√©lan des jambes, pas les bras",
                    "Apprenez avec un coach qualifi√©"
                ],
                muscles: { principaux: ["Corps entier"], secondaires: ["Quadriceps", "Fessiers", "√âpaules", "Triceps"] }
            },
            'Front Squat': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Barbell_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Front_Barbell_Squat/1.jpg',
                execution: [
                    "Barre en position front rack (sur les delto√Ødes)",
                    "Coudes hauts, pieds largeur d'√©paules",
                    "Descendez en gardant le buste tr√®s vertical",
                    "Remontez en gardant les coudes hauts"
                ],
                vigilance: [
                    "Les coudes doivent rester hauts",
                    "Travaillez la mobilit√© des poignets si n√©cessaire",
                    "Le buste reste plus droit qu'au back squat",
                    "Excellent transfert vers le clean"
                ],
                muscles: { principaux: ["Quadriceps"], secondaires: ["Core", "Haut du dos", "Fessiers"] }
            },
            'Overhead Squat': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Overhead_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Overhead_Squat/1.jpg',
                execution: [
                    "Barre au-dessus de la t√™te, prise snatch (large)",
                    "Bras verrouill√©s, √©paules actives",
                    "Descendez en squat profond",
                    "Gardez la barre au-dessus du milieu du pied"
                ],
                vigilance: [
                    "Demande une excellente mobilit√© (√©paules, hanches, chevilles)",
                    "Commencez avec un b√¢ton ou une barre vide",
                    "Les bras restent verrouill√©s tout le long",
                    "Exercice de mobilit√© autant que de force"
                ],
                muscles: { principaux: ["Quadriceps", "Core"], secondaires: ["√âpaules", "Haut du dos", "Fessiers"] }
            },
            'Muscle-ups': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/1.jpg',
                execution: [
                    "Suspendez-vous √† la barre ou aux anneaux",
                    "Tirez-vous puissamment en amenant les hanches vers la barre",
                    "Basculez au-dessus de la barre (transition)",
                    "Poussez pour terminer bras tendus au-dessus"
                ],
                vigilance: [
                    "Ma√Ætrisez d'abord tractions et dips s√©par√©ment",
                    "La transition est la partie la plus technique",
                    "Le kipping aide mais apprenez aussi le strict",
                    "Progression : tractions hautes puis muscle-ups assist√©s"
                ],
                muscles: { principaux: ["Dorsaux", "Pectoraux", "Triceps"], secondaires: ["Biceps", "Core"] }
            },
            'HSPU': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Handstand_Push-Ups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Handstand_Push-Ups/1.jpg',
                execution: [
                    "En appui contre un mur, t√™te en bas",
                    "Mains l√©g√®rement plus larges que les √©paules",
                    "Descendez jusqu'√† ce que la t√™te touche le sol",
                    "Poussez pour revenir en position haute"
                ],
                vigilance: [
                    "Commencez par des pike push-ups ou HSPU sur box",
                    "Gardez le corps gain√© contre le mur",
                    "Ne vous laissez pas tomber sur la t√™te",
                    "Progressez vers le HSPU strict puis kipping"
                ],
                muscles: { principaux: ["Delto√Ødes", "Triceps"], secondaires: ["Trap√®zes", "Core"] }
            },
            'Toes-to-bar': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Hanging_Leg_Raise/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Hanging_Leg_Raise/1.jpg',
                execution: [
                    "Suspendez-vous √† la barre, bras tendus",
                    "Levez les jambes tendues vers la barre",
                    "Touchez la barre avec les orteils",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "Commencez par des relev√©s de genoux",
                    "Utilisez le kipping pour plus de r√©p√©titions",
                    "Version stricte = plus de travail abdominal",
                    "Maintenez une prise solide sur la barre"
                ],
                muscles: { principaux: ["Abdominaux", "Fl√©chisseurs de hanches"], secondaires: ["Dorsaux", "Avant-bras"] }
            },
            'Pistol Squats': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pistol_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pistol_Squat/1.jpg',
                execution: [
                    "Debout sur une jambe, l'autre tendue devant",
                    "Descendez en squat complet sur une jambe",
                    "Gardez l'autre jambe tendue devant vous",
                    "Remontez sans poser l'autre pied"
                ],
                vigilance: [
                    "Demande force, √©quilibre et mobilit√©",
                    "Commencez assist√© (main sur un support)",
                    "Gardez le talon au sol",
                    "Le genou peut d√©passer les orteils (c'est normal)"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Core", "Mollets"] }
            },
            'Thrusters': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Thrusters/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Thrusters/1.jpg',
                execution: [
                    "Barre en position front rack",
                    "Descendez en front squat",
                    "Remontez explosif et utilisez l'√©lan pour pousser la barre overhead",
                    "Verrouillez bras tendus puis redescendez"
                ],
                vigilance: [
                    "Le mouvement doit √™tre fluide (squat ‚Üí press)",
                    "L'√©lan des jambes aide √† pousser la barre",
                    "Gardez les coudes hauts dans le squat",
                    "Exercice tr√®s cardio - g√©rez votre respiration"
                ],
                muscles: { principaux: ["Quadriceps", "Delto√Ødes"], secondaires: ["Fessiers", "Triceps", "Core"] }
            },
            'Burpees': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Burpee/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Burpee/1.jpg',
                execution: [
                    "Debout, descendez en squat mains au sol",
                    "Jetez les pieds en arri√®re (position pompe)",
                    "Faites une pompe (optionnel)",
                    "Ramenez les pieds et sautez bras en l'air"
                ],
                vigilance: [
                    "Gardez le core gain√© en position pompe",
                    "Atterrissez en douceur sur les sauts",
                    "Adaptez la vitesse √† votre niveau",
                    "Respirez r√©guli√®rement malgr√© l'effort"
                ],
                muscles: { principaux: ["Corps entier"], secondaires: ["Cardio", "Pectoraux", "Quadriceps"] }
            },
            'WOD': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Burpee/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Burpee/1.jpg',
                execution: [
                    "WOD = Workout Of the Day (entra√Ænement du jour)",
                    "Suivez le format indiqu√© (AMRAP, For Time, EMOM...)",
                    "Encha√Ænez les exercices selon le protocole",
                    "Notez votre score (temps, rounds, reps)"
                ],
                vigilance: [
                    "√âchauffez-vous correctement avant",
                    "Adaptez les charges et mouvements √† votre niveau",
                    "La technique prime sur la vitesse",
                    "Hydratez-vous et r√©cup√©rez apr√®s"
                ],
                muscles: { principaux: ["Corps entier"], secondaires: [] }
            },

            // ========== POIDS DE CORPS ==========
            'Pompes': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pushups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pushups/1.jpg',
                execution: [
                    "Mains au sol l√©g√®rement plus larges que les √©paules",
                    "Corps gain√©, align√© de la t√™te aux talons",
                    "Descendez en fl√©chissant les coudes jusqu'√† fr√¥ler le sol",
                    "Poussez pour revenir bras tendus"
                ],
                vigilance: [
                    "Gardez le corps parfaitement gain√© (pas de dos creux)",
                    "Coudes √† 45¬∞ du corps, pas √©cart√©s √† 90¬∞",
                    "Descendez la poitrine, pas le menton",
                    "Extension compl√®te des bras en haut"
                ],
                muscles: { principaux: ["Pectoraux", "Triceps"], secondaires: ["Delto√Ødes ant√©rieurs", "Core"] }
            },
            'Pompes d√©clin√©es': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Decline_Push-Up/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Decline_Push-Up/1.jpg',
                execution: [
                    "Pieds sur√©lev√©s sur un banc ou une chaise",
                    "Mains au sol, corps gain√©",
                    "Descendez jusqu'√† ce que la poitrine fr√¥le le sol",
                    "Poussez pour remonter"
                ],
                vigilance: [
                    "Plus les pieds sont hauts, plus c'est difficile",
                    "Cible davantage le haut des pectoraux",
                    "Gardez le corps align√© (pas de dos creux)",
                    "Progression : augmentez la hauteur des pieds"
                ],
                muscles: { principaux: ["Pectoraux sup√©rieurs", "Triceps"], secondaires: ["Delto√Ødes", "Core"] }
            },
            'Pike push-ups': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pike_Push_Press/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pike_Push_Press/1.jpg',
                execution: [
                    "Position de V invers√© (hanches hautes)",
                    "Mains au sol, pieds au sol, fesses vers le plafond",
                    "Descendez la t√™te vers le sol entre les mains",
                    "Poussez pour remonter"
                ],
                vigilance: [
                    "Plus les pieds sont proches des mains, plus c'est difficile",
                    "Excellent pour progresser vers le HSPU",
                    "Gardez les jambes tendues si possible",
                    "La t√™te descend devant les mains"
                ],
                muscles: { principaux: ["Delto√Ødes", "Triceps"], secondaires: ["Pectoraux sup√©rieurs"] }
            },
            'Dips sur chaise': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bench_Dips/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Bench_Dips/1.jpg',
                execution: [
                    "Mains sur le bord d'une chaise derri√®re vous",
                    "Jambes tendues devant ou pieds au sol (plus facile)",
                    "Descendez en fl√©chissant les coudes",
                    "Poussez pour remonter bras tendus"
                ],
                vigilance: [
                    "Ne descendez pas trop bas (stress sur les √©paules)",
                    "Gardez les coudes vers l'arri√®re, pas √©cart√©s",
                    "La chaise doit √™tre stable",
                    "Progression : jambes tendues puis sur√©lev√©es"
                ],
                muscles: { principaux: ["Triceps"], secondaires: ["Pectoraux", "Delto√Ødes ant√©rieurs"] }
            },
            'Tractions porte': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Pullups/1.jpg',
                execution: [
                    "Utilisez une barre de traction de porte",
                    "Suspendez-vous, prise pronation ou supination",
                    "Tirez-vous jusqu'√† ce que le menton d√©passe la barre",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "V√©rifiez la solidit√© de l'installation",
                    "Commencez par des tractions n√©gatives si n√©cessaire",
                    "Gardez le corps gain√©",
                    "Alternative : tractions australiennes sous une table"
                ],
                muscles: { principaux: ["Dorsaux"], secondaires: ["Biceps", "Avant-bras"] }
            },
            'Rowing invers√© (table)': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Inverted_Row/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Inverted_Row/1.jpg',
                execution: [
                    "Allongez-vous sous une table solide",
                    "Saisissez le bord de la table, corps align√©",
                    "Tirez-vous vers la table en serrant les omoplates",
                    "Redescendez de fa√ßon contr√¥l√©e"
                ],
                vigilance: [
                    "La table doit √™tre suffisamment lourde et stable",
                    "Gardez le corps gain√© et droit",
                    "Plus vous √™tes horizontal, plus c'est difficile",
                    "Excellent pour progresser vers les tractions"
                ],
                muscles: { principaux: ["Dorsaux", "Trap√®zes"], secondaires: ["Biceps", "Core"] }
            },
            'Squats saut√©s': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Freehand_Jump_Squat/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Freehand_Jump_Squat/1.jpg',
                execution: [
                    "Position de squat classique",
                    "Descendez en squat",
                    "Explosez vers le haut en sautant",
                    "Atterrissez en douceur et encha√Ænez"
                ],
                vigilance: [
                    "Atterrissez sur l'avant du pied, genoux fl√©chis",
                    "Gardez les genoux align√©s avec les pieds",
                    "Exercice intense pour les articulations",
                    "Progressez d'abord sur les squats classiques"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Mollets", "Core"] }
            },
            'Fentes altern√©es': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Dumbbell_Lunges_-_Walking/1.jpg',
                execution: [
                    "Debout, faites un pas en avant",
                    "Descendez jusqu'√† ce que le genou arri√®re fr√¥le le sol",
                    "Revenez en position debout",
                    "Alternez avec l'autre jambe"
                ],
                vigilance: [
                    "Gardez le buste droit",
                    "Le genou avant ne d√©passe pas les orteils",
                    "Poussez √† travers le talon avant",
                    "√âquilibrez les r√©p√©titions des deux c√¥t√©s"
                ],
                muscles: { principaux: ["Quadriceps", "Fessiers"], secondaires: ["Ischio-jambiers"] }
            },
            'Pont fessier': {
                image: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Glute_Bridge/0.jpg',
                image2: 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/Glute_Bridge/1.jpg',
                execution: [
                    "Allong√© sur le dos, genoux pli√©s, pieds au sol",
                    "Poussez les hanches vers le plafond",
                    "Contractez fort les fessiers en haut",
                    "Redescendez sans toucher le sol"
                ],
                vigilance: [
                    "Ne cambrez pas excessivement le dos",
                    "La force vient des fessiers, pas du dos",
                    "Gardez les abdos engag√©s",
                    "Progression : unilat√©ral puis lest√©"
                ],
                muscles: { principaux: ["Fessiers"], secondaires: ["Ischio-jambiers", "Core"] }
            }
        };

        // ==================== STATE ====================
        let appState = {
            settings: {
                soundEnabled: true,
                restTime: 90,
                userLevel: 'intermediaire', // 'debutant', 'intermediaire', 'avance'
                bisetEnabled: true,
                sessionsPerWeek: 4,
                autoExportEnabled: false
            },
            weightLossGoal: null, // { startWeight, targetWeight, startDate, targetDate }
            weightHistory: [], // [{ date, weight }]
            currentCycle: null,
            currentWorkout: null,
            workoutStartTime: null,
            mainTimerInterval: null,
            restTimerInterval: null,
            currentExerciseIndex: 0,
            currentSeriesIndex: 0,
            inBiset: false,
            currentExerciseData: [],
            selectedWorkoutMode: 'normal',
            selectedProgram: 'mixte',
            selectedDuration: 8,
            sessions: [],
            cardioSessions: [],
            crossfitSessions: [],
            exerciseHistory: {}
        };

        // ==================== AUDIO ====================
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playBeep(frequency = 800, duration = 200) {
            if (!appState.settings.soundEnabled) return;
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration / 1000);
        }

        function playSuccessSound() {
            playBeep(523, 100);
            setTimeout(() => playBeep(659, 100), 100);
            setTimeout(() => playBeep(784, 200), 200);
        }

        function playRestEndSound() {
            playBeep(880, 150);
            setTimeout(() => playBeep(880, 150), 200);
            setTimeout(() => playBeep(880, 300), 400);
        }

        // ==================== STORAGE ====================
        function saveState() {
            localStorage.setItem('fittracker_data', JSON.stringify({
                settings: appState.settings,
                currentCycle: appState.currentCycle,
                sessions: appState.sessions,
                cardioSessions: appState.cardioSessions,
                crossfitSessions: appState.crossfitSessions,
                exerciseHistory: appState.exerciseHistory,
                weightLossGoal: appState.weightLossGoal,
                weightHistory: appState.weightHistory
            }));
        }

        function loadState() {
            const saved = localStorage.getItem('fittracker_data');
            if (saved) {
                const data = JSON.parse(saved);
                // Merge settings to preserve new defaults
                appState.settings = { ...appState.settings, ...data.settings };
                appState.currentCycle = data.currentCycle || null;
                appState.sessions = data.sessions || [];
                appState.cardioSessions = data.cardioSessions || [];
                appState.crossfitSessions = data.crossfitSessions || [];
                appState.exerciseHistory = data.exerciseHistory || {};
                appState.weightLossGoal = data.weightLossGoal || null;
                appState.weightHistory = data.weightHistory || [];

                // Update UI elements
                document.getElementById('soundToggle').checked = appState.settings.soundEnabled;
                document.getElementById('restTimeSelect').value = appState.settings.restTime;
                document.getElementById('userLevelSelect').value = appState.settings.userLevel;
                document.getElementById('bisetToggle').checked = appState.settings.bisetEnabled;
                document.getElementById('sessionsPerWeekSelect').value = appState.settings.sessionsPerWeek;
                document.getElementById('autoExportToggle').checked = appState.settings.autoExportEnabled;
            }
        }

        function exportData() {
            const data = {
                settings: appState.settings,
                currentCycle: appState.currentCycle,
                sessions: appState.sessions,
                cardioSessions: appState.cardioSessions,
                crossfitSessions: appState.crossfitSessions,
                exerciseHistory: appState.exerciseHistory,
                weightLossGoal: appState.weightLossGoal,
                weightHistory: appState.weightHistory,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fittracker_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('Donn√©es sauvegard√©es !');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    // Merge settings to preserve new defaults
                    appState.settings = { ...appState.settings, ...data.settings };
                    appState.currentCycle = data.currentCycle || null;
                    appState.sessions = data.sessions || [];
                    appState.cardioSessions = data.cardioSessions || [];
                    appState.crossfitSessions = data.crossfitSessions || [];
                    appState.exerciseHistory = data.exerciseHistory || {};
                    appState.weightLossGoal = data.weightLossGoal || null;
                    appState.weightHistory = data.weightHistory || [];
                    saveState();
                    updateUI();
                    showToast('Donn√©es import√©es !');
                } catch (err) {
                    showToast('Erreur lors de l\'import');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function confirmReset() {
            if (confirm('Supprimer toutes les donn√©es ?')) {
                localStorage.removeItem('fittracker_data');
                appState.sessions = [];
                appState.cardioSessions = [];
                appState.crossfitSessions = [];
                appState.exerciseHistory = {};
                appState.currentCycle = null;
                appState.weightLossGoal = null;
                appState.weightHistory = [];
                updateUI();
                showToast('Donn√©es r√©initialis√©es');
            }
        }

        // ==================== NAVIGATION ====================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            if (pageId === 'statsPage') updateStats();
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ==================== CYCLE MANAGEMENT ====================
        function showProgramSelection() {
            closeCycleEndModal();
            document.getElementById('programModal').classList.add('show');
        }

        function closeProgramModal() {
            document.getElementById('programModal').classList.remove('show');
        }

        function selectProgram(programId) {
            appState.selectedProgram = programId;
            document.querySelectorAll('.program-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-program="${programId}"]`).classList.add('active');
        }

        function selectDuration(weeks) {
            appState.selectedDuration = weeks;
            document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`[data-weeks="${weeks}"]`).classList.add('active');
        }

        function startCycle() {
            const program = PROGRAMS[appState.selectedProgram];
            appState.currentCycle = {
                programId: appState.selectedProgram,
                startDate: new Date().toISOString(),
                endDate: new Date(Date.now() + appState.selectedDuration * 7 * 24 * 60 * 60 * 1000).toISOString(),
                durationWeeks: appState.selectedDuration,
                sessionsCompleted: 0,
                startingWeights: {},
                currentWorkoutIndex: 0
            };
            appState.settings.restTime = program.restTime;
            document.getElementById('restTimeSelect').value = program.restTime;
            saveState();
            closeProgramModal();
            updateUI();
            showToast(`Cycle ${program.name} d√©marr√© !`);
        }

        function extendCycle() {
            if (appState.currentCycle) {
                const newEnd = new Date(appState.currentCycle.endDate);
                newEnd.setDate(newEnd.getDate() + 28);
                appState.currentCycle.endDate = newEnd.toISOString();
                appState.currentCycle.durationWeeks += 4;
                saveState();
                closeCycleEndModal();
                updateUI();
                showToast('Cycle prolong√© de 4 semaines !');
            }
        }

        function checkCycleEnd() {
            if (!appState.currentCycle) return;
            const now = new Date();
            const endDate = new Date(appState.currentCycle.endDate);
            if (now >= endDate) {
                showCycleEndModal();
            }
        }

        function showCycleEndModal() {
            const cycle = appState.currentCycle;
            const program = PROGRAMS[cycle.programId];
            const startDate = new Date(cycle.startDate);
            const cycleSessions = appState.sessions.filter(s =>
                new Date(s.date) >= startDate && s.type === 'musculation'
            );
            const totalVolume = cycleSessions.reduce((a, b) => a + (b.totalVolume || 0), 0);
            const totalTime = cycleSessions.reduce((a, b) => a + (b.duration || 0), 0);

            let html = `
                <div class="cycle-card ${program.gradient}" style="margin-bottom: 20px;">
                    <div class="cycle-name">${program.icon} ${program.name}</div>
                    <div style="margin-top: 8px; opacity: 0.9;">${cycle.durationWeeks} semaines compl√©t√©es</div>
                </div>

                <div class="bilan-section">
                    <div class="bilan-title">üìä R√©sum√© du cycle</div>
                    <div class="bilan-stat-row">
                        <span>S√©ances effectu√©es</span>
                        <span><strong>${cycleSessions.length}</strong></span>
                    </div>
                    <div class="bilan-stat-row">
                        <span>Volume total</span>
                        <span><strong>${(totalVolume / 1000).toFixed(1)} tonnes</strong></span>
                    </div>
                    <div class="bilan-stat-row">
                        <span>Temps d'entra√Ænement</span>
                        <span><strong>${(totalTime / 3600).toFixed(1)} heures</strong></span>
                    </div>
                </div>

                <p style="color: var(--text-secondary); font-size: 14px; margin-top: 16px;">
                    Tu peux prolonger ce cycle ou en d√©marrer un nouveau avec un objectif diff√©rent.
                </p>
            `;

            document.getElementById('cycleEndContent').innerHTML = html;
            document.getElementById('cycleEndModal').classList.add('show');
        }

        function closeCycleEndModal() {
            document.getElementById('cycleEndModal').classList.remove('show');
        }

        // ==================== WORKOUT LOGIC ====================
        function getNextWorkout() {
            if (!appState.currentCycle) return null;

            const program = PROGRAMS[appState.currentCycle.programId];
            const workoutKeys = Object.keys(program.workouts);
            const index = appState.currentCycle.currentWorkoutIndex % workoutKeys.length;
            return program.workouts[workoutKeys[index]];
        }

        function getExerciseWithVariant(exercise) {
            if (!exercise.variants || exercise.variants.length <= 1) return exercise.name;
            const randomIndex = Math.floor(Math.random() * exercise.variants.length);
            return exercise.variants[randomIndex];
        }

        function getLastWeight(exerciseId) {
            if (appState.exerciseHistory[exerciseId]?.length > 0) {
                return appState.exerciseHistory[exerciseId].slice(-1)[0].weight;
            }
            return null;
        }

        function startWorkout() {
            if (!appState.currentCycle) {
                showProgramSelection();
                return;
            }

            checkCycleEnd();
            if (document.getElementById('cycleEndModal').classList.contains('show')) return;

            const nextWorkout = getNextWorkout();
            if (!nextWorkout) return;

            document.getElementById('modeSessionTitle').textContent = nextWorkout.name;
            appState.selectedWorkoutMode = 'normal';
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('active'));
            document.querySelector('[data-mode="normal"]').classList.add('active');
            document.getElementById('modeModal').classList.add('show');
        }

        function selectWorkoutMode(mode) {
            appState.selectedWorkoutMode = mode;
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
        }

        function closeModeModal() {
            document.getElementById('modeModal').classList.remove('show');
        }

        function confirmWorkoutMode() {
            closeModeModal();
            launchWorkout();
        }

        function launchWorkout() {
            const baseWorkout = getNextWorkout();
            const isBodyweight = appState.selectedWorkoutMode === 'bodyweight';
            const levelAdj = getLevelAdjustments();
            const bisetEnabled = appState.settings.bisetEnabled;

            // Apply level adjustments to rest time
            const baseRestTime = appState.settings.restTime;
            const adjustedRestTime = Math.max(30, baseRestTime + levelAdj.restModifier);

            // Filter exercises based on level (max exercises for beginners)
            let exercises = baseWorkout.exercises;
            if (levelAdj.maxExercises < exercises.length) {
                exercises = exercises.slice(0, levelAdj.maxExercises);
            }

            appState.currentWorkout = {
                ...baseWorkout,
                isBodyweight,
                adjustedRestTime,
                generatedExercises: exercises.map(ex => {
                    let name = getExerciseWithVariant(ex);
                    if (isBodyweight) {
                        name = BODYWEIGHT_EXERCISES[name] || BODYWEIGHT_EXERCISES[ex.name] || BODYWEIGHT_EXERCISES['default'];
                    }

                    // Apply level adjustment to sets
                    const adjustedSets = Math.max(1, ex.sets + levelAdj.setsModifier);

                    // Handle biset based on settings
                    const biset = bisetEnabled ? ex.biset : null;
                    if (biset) {
                        biset.sets = Math.max(1, biset.sets + levelAdj.setsModifier);
                    }

                    return {
                        ...ex,
                        sets: adjustedSets,
                        biset: biset,
                        displayName: name,
                        selectedVariant: name
                    };
                })
            };

            appState.workoutStartTime = Date.now();
            appState.currentExerciseIndex = 0;
            appState.currentSeriesIndex = 0;
            appState.inBiset = false;
            appState.currentExerciseData = [];

            appState.currentWorkout.generatedExercises.forEach(ex => {
                const lastWeight = getLastWeight(ex.id);
                appState.currentExerciseData.push({
                    id: ex.id,
                    name: ex.displayName,
                    sets: ex.sets,
                    completedSets: [],
                    currentWeight: isBodyweight ? 0 : (lastWeight !== null ? lastWeight : ex.defaultWeight)
                });

                if (ex.biset) {
                    let bisetName = ex.biset.name;
                    if (isBodyweight) {
                        bisetName = BODYWEIGHT_EXERCISES[ex.biset.name] || BODYWEIGHT_EXERCISES['default'];
                    }
                    const bisetLastWeight = getLastWeight(ex.biset.id);
                    appState.currentExerciseData.push({
                        id: ex.biset.id,
                        name: bisetName,
                        sets: ex.biset.sets,
                        completedSets: [],
                        currentWeight: isBodyweight ? 0 : (bisetLastWeight !== null ? bisetLastWeight : ex.biset.defaultWeight),
                        isBiset: true,
                        parentId: ex.id
                    });
                }
            });

            document.getElementById('workoutTitle').textContent = appState.currentWorkout.name;
            document.getElementById('workoutSubtitle').textContent = isBodyweight ? 'Mode Voyage' : 'S√©ance en cours';
            document.getElementById('warmupCard').style.display = 'block';

            const warmupList = document.getElementById('warmupList');
            warmupList.innerHTML = isBodyweight ? `
                <li>2 min mont√©es de genoux</li>
                <li>Rotations articulaires</li>
                <li>10 squats lents</li>
                <li>10 pompes lentes</li>
            ` : `
                <li>2 min corde √† sauter</li>
                <li>Rotations d'√©paules</li>
                <li>Mobilit√© articulaire</li>
                <li>1 s√©rie l√©g√®re du 1er exercice</li>
            `;

            renderExercisesList();
            startMainTimer();
            showPage('workoutPage');

            if (audioContext.state === 'suspended') audioContext.resume();
        }

        function hideWarmup() {
            document.getElementById('warmupCard').style.display = 'none';
        }

        function renderExercisesList() {
            const container = document.getElementById('exercisesList');
            const workout = appState.currentWorkout;

            let html = '';
            workout.generatedExercises.forEach((ex, index) => {
                const mainData = appState.currentExerciseData.find(d => d.id === ex.id);
                const isCompleted = mainData && mainData.completedSets.length >= ex.sets;
                const isActive = appState.currentExerciseIndex === index;
                const weight = mainData?.currentWeight || 0;
                const weightDisplay = weight > 0 ? ` ‚Ä¢ ${weight} kg` : '';
                const isVariant = ex.variants && ex.displayName !== ex.name;

                html += `
                    <div class="exercise-item ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''}" onclick="selectExercise(${index})">
                        <div class="exercise-name">
                            ${ex.displayName}
                            ${workout.isBodyweight ? '<span class="bodyweight-badge">PDC</span>' : ''}
                            ${isVariant && !workout.isBodyweight ? '<span class="variant-badge">Variante</span>' : ''}
                        </div>
                        <div class="exercise-details">${ex.sets} s√©ries x ${ex.reps}${weightDisplay}</div>
                        ${ex.biset ? `
                            <div class="exercise-biset">
                                <span class="biset-badge">BISET</span>
                                <span>${workout.isBodyweight ? (BODYWEIGHT_EXERCISES[ex.biset.name] || ex.biset.name) : ex.biset.name}</span>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = html;

            const allCompleted = appState.currentExerciseData.every(d => d.completedSets.length >= d.sets);
            const finishBtn = document.getElementById('finishWorkoutBtn');
            if (allCompleted) {
                finishBtn.classList.remove('btn-secondary');
                finishBtn.classList.add('btn-success');
            } else {
                finishBtn.classList.remove('btn-success');
                finishBtn.classList.add('btn-secondary');
            }
        }

        function selectExercise(index) {
            appState.currentExerciseIndex = index;
            const workout = appState.currentWorkout;
            const exercise = workout.generatedExercises[index];
            const exerciseData = appState.currentExerciseData.find(d => d.id === exercise.id);

            // V√©rifier si on doit reprendre sur le biset
            if (exercise.biset) {
                const bisetData = appState.currentExerciseData.find(d => d.id === exercise.biset.id);
                if (bisetData.completedSets.length < exerciseData.completedSets.length) {
                    // On doit reprendre sur le biset
                    appState.currentSeriesIndex = exerciseData.completedSets.length - 1;
                    const bisetName = workout.isBodyweight ?
                        (BODYWEIGHT_EXERCISES[exercise.biset.name] || exercise.biset.name) :
                        exercise.biset.name;
                    document.getElementById('exerciseTitle').textContent = bisetName;
                    document.getElementById('exerciseInfo').textContent = `${exercise.biset.sets} s√©ries x ${exercise.biset.reps}`;
                    document.getElementById('weightInput').value = bisetData.currentWeight;
                    document.getElementById('repsInput').value = parseInt(exercise.biset.reps) || 12;
                    document.getElementById('currentSeries').textContent = exerciseData.completedSets.length;
                    document.getElementById('totalSeriesCount').textContent = exercise.sets;
                    document.getElementById('seriesBadge').textContent = 'Biset';

                    const isBisetBodyweight = workout.isBodyweight || bisetData.currentWeight === 0;
                    document.getElementById('weightContainer').style.display = isBisetBodyweight ? 'none' : 'flex';
                    document.getElementById('bodyweightIndicator').style.display = isBisetBodyweight ? 'block' : 'none';

                    appState.inBiset = true;
                    renderSeriesProgress(exercise.sets, appState.currentSeriesIndex);
                    displayExerciseDetails(bisetName);
                    showPage('exercisePage');
                    return;
                }
            }

            appState.currentSeriesIndex = exerciseData.completedSets.length;

            // V√©rifier si l'exercice ET son biset sont termin√©s
            if (appState.currentSeriesIndex >= exercise.sets) {
                if (exercise.biset) {
                    const bisetData = appState.currentExerciseData.find(d => d.id === exercise.biset.id);
                    if (bisetData.completedSets.length >= exercise.biset.sets) {
                        showToast('Exercice d√©j√† termin√© !');
                        return;
                    }
                } else {
                    showToast('Exercice d√©j√† termin√© !');
                    return;
                }
            }

            appState.inBiset = false;
            document.getElementById('exerciseTitle').textContent = exercise.displayName;
            document.getElementById('exerciseInfo').textContent = `${exercise.sets} s√©ries x ${exercise.reps}`;
            document.getElementById('weightInput').value = exerciseData.currentWeight;
            document.getElementById('repsInput').value = parseInt(exercise.reps) || 10;
            document.getElementById('currentSeries').textContent = appState.currentSeriesIndex + 1;
            document.getElementById('totalSeriesCount').textContent = exercise.sets;
            document.getElementById('seriesBadge').textContent = 'En cours';

            const isBodyweight = workout.isBodyweight || exerciseData.currentWeight === 0;
            document.getElementById('weightContainer').style.display = isBodyweight ? 'none' : 'flex';
            document.getElementById('bodyweightIndicator').style.display = isBodyweight ? 'block' : 'none';

            renderSeriesProgress(exercise.sets, appState.currentSeriesIndex);
            displayExerciseDetails(exercise.displayName || exercise.name);
            showPage('exercisePage');
        }

        function renderSeriesProgress(total, current) {
            let html = '';
            for (let i = 0; i < total; i++) {
                let className = 'series-dot';
                if (i < current) className += ' completed';
                if (i === current) className += ' active';
                html += `<div class="${className}"></div>`;
            }
            document.getElementById('seriesProgress').innerHTML = html;
        }

        function toggleExerciseDetails() {
            const toggle = document.getElementById('detailsToggle');
            const content = document.getElementById('detailsContent');
            toggle.classList.toggle('open');
            content.classList.toggle('open');

            if (content.classList.contains('open')) {
                toggle.querySelector('span:first-child').textContent = 'Masquer les instructions';
            } else {
                toggle.querySelector('span:first-child').textContent = 'Voir les instructions';
            }
        }

        function displayExerciseDetails(exerciseName) {
            const panel = document.getElementById('exerciseDetailsPanel');
            const img1 = document.getElementById('exerciseImg1');
            const img2 = document.getElementById('exerciseImg2');
            const executionList = document.getElementById('executionList');
            const vigilanceList = document.getElementById('vigilanceList');
            const musclesTags = document.getElementById('musclesTags');
            const detailsContent = document.getElementById('detailsContent');
            const detailsToggle = document.getElementById('detailsToggle');

            // Chercher les d√©tails de l'exercice (essayer plusieurs variantes du nom)
            let details = EXERCISE_DETAILS[exerciseName];

            // Si pas trouv√©, essayer sans les pr√©fixes/suffixes courants
            if (!details) {
                const baseName = exerciseName
                    .replace(' lest√©es', '')
                    .replace(' lest√©s', '')
                    .replace(' lourd', '')
                    .replace(' halt√®re', '')
                    .replace(' barre', '')
                    .replace(' √©lastique', '');
                details = EXERCISE_DETAILS[baseName];
            }

            // Si toujours pas trouv√©, chercher une correspondance partielle
            if (!details) {
                const keys = Object.keys(EXERCISE_DETAILS);
                const matchingKey = keys.find(key =>
                    exerciseName.toLowerCase().includes(key.toLowerCase()) ||
                    key.toLowerCase().includes(exerciseName.toLowerCase())
                );
                if (matchingKey) {
                    details = EXERCISE_DETAILS[matchingKey];
                }
            }

            if (!details) {
                panel.style.display = 'none';
                return;
            }

            // Afficher le panneau
            panel.style.display = 'block';

            // Charger les images
            img1.src = details.image;
            img2.src = details.image2;

            // G√©rer les erreurs de chargement d'image
            img1.onerror = () => { img1.style.display = 'none'; };
            img2.onerror = () => { img2.style.display = 'none'; };
            img1.onload = () => { img1.style.display = 'block'; };
            img2.onload = () => { img2.style.display = 'block'; };

            // Remplir la liste d'ex√©cution
            executionList.innerHTML = details.execution
                .map(step => `<li>${step}</li>`)
                .join('');

            // Remplir les points de vigilance
            vigilanceList.innerHTML = details.vigilance
                .map(point => `<li>${point}</li>`)
                .join('');

            // Remplir les muscles
            let musclesHtml = '';
            if (details.muscles.principaux) {
                musclesHtml += details.muscles.principaux
                    .map(m => `<span class="muscle-tag primary">${m}</span>`)
                    .join('');
            }
            if (details.muscles.secondaires && details.muscles.secondaires.length > 0) {
                musclesHtml += details.muscles.secondaires
                    .map(m => `<span class="muscle-tag secondary">${m}</span>`)
                    .join('');
            }
            musclesTags.innerHTML = musclesHtml;

            // R√©initialiser l'√©tat du toggle (ferm√© par d√©faut)
            detailsContent.classList.remove('open');
            detailsToggle.classList.remove('open');
            detailsToggle.querySelector('span:first-child').textContent = 'Voir les instructions';
        }

        function adjustWeight(delta) {
            const input = document.getElementById('weightInput');
            input.value = Math.max(0, parseFloat(input.value) + delta);
        }

        function adjustReps(delta) {
            const input = document.getElementById('repsInput');
            input.value = Math.max(1, parseInt(input.value) + delta);
        }

        function validateSeries() {
            const weight = parseFloat(document.getElementById('weightInput').value) || 0;
            const reps = parseInt(document.getElementById('repsInput').value);

            const workout = appState.currentWorkout;
            const exercise = workout.generatedExercises[appState.currentExerciseIndex];
            const exerciseData = appState.currentExerciseData.find(d => d.id === exercise.id);

            playSuccessSound();

            // Si on est sur le biset, valider sur le biset
            if (appState.inBiset && exercise.biset) {
                const bisetData = appState.currentExerciseData.find(d => d.id === exercise.biset.id);
                bisetData.completedSets.push({ weight, reps });
                bisetData.currentWeight = weight;
                appState.inBiset = false;

                appState.currentSeriesIndex++;

                if (appState.currentSeriesIndex >= exercise.sets) {
                    showToast('Exercice termin√© !');
                    backToExercises();
                } else {
                    // Remettre l'affichage sur l'exercice principal pour la s√©rie suivante
                    document.getElementById('exerciseTitle').textContent = exercise.displayName;
                    document.getElementById('exerciseInfo').textContent = `${exercise.sets} s√©ries x ${exercise.reps}`;
                    document.getElementById('weightInput').value = exerciseData.currentWeight;
                    document.getElementById('repsInput').value = parseInt(exercise.reps) || 10;
                    document.getElementById('currentSeries').textContent = appState.currentSeriesIndex + 1;
                    document.getElementById('seriesBadge').textContent = 'En cours';

                    const isBodyweight = workout.isBodyweight || exerciseData.currentWeight === 0;
                    document.getElementById('weightContainer').style.display = isBodyweight ? 'none' : 'flex';
                    document.getElementById('bodyweightIndicator').style.display = isBodyweight ? 'block' : 'none';

                    renderSeriesProgress(exercise.sets, appState.currentSeriesIndex);
                    displayExerciseDetails(exercise.displayName || exercise.name);
                    startRestTimer();
                }
                return;
            }

            // Valider sur l'exercice principal
            exerciseData.completedSets.push({ weight, reps });
            exerciseData.currentWeight = weight;

            // S'il y a un biset, passer au biset
            if (exercise.biset) {
                const bisetData = appState.currentExerciseData.find(d => d.id === exercise.biset.id);
                const bisetName = workout.isBodyweight ?
                    (BODYWEIGHT_EXERCISES[exercise.biset.name] || exercise.biset.name) :
                    exercise.biset.name;
                document.getElementById('exerciseTitle').textContent = bisetName;
                document.getElementById('exerciseInfo').textContent = `${exercise.biset.sets} s√©ries x ${exercise.biset.reps}`;
                document.getElementById('weightInput').value = bisetData.currentWeight;
                document.getElementById('repsInput').value = parseInt(exercise.biset.reps) || 12;
                document.getElementById('seriesBadge').textContent = 'Biset';

                const isBisetBodyweight = workout.isBodyweight || bisetData.currentWeight === 0;
                document.getElementById('weightContainer').style.display = isBisetBodyweight ? 'none' : 'flex';
                document.getElementById('bodyweightIndicator').style.display = isBisetBodyweight ? 'block' : 'none';

                displayExerciseDetails(bisetName);
                appState.inBiset = true;
                return;
            }

            appState.currentSeriesIndex++;

            if (appState.currentSeriesIndex >= exercise.sets) {
                showToast('Exercice termin√© !');
                backToExercises();
            } else {
                document.getElementById('currentSeries').textContent = appState.currentSeriesIndex + 1;
                document.getElementById('seriesBadge').textContent = 'En cours';
                renderSeriesProgress(exercise.sets, appState.currentSeriesIndex);
                startRestTimer();
            }
        }

        function backToExercises() {
            renderExercisesList();
            showPage('workoutPage');
        }

        function startMainTimer() {
            clearInterval(appState.mainTimerInterval);
            appState.mainTimerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - appState.workoutStartTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                document.getElementById('mainTimer').textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function startRestTimer() {
            const overlay = document.getElementById('restOverlay');
            const timerDisplay = document.getElementById('restTimer');
            // Use adjusted rest time if available (level-based), otherwise use settings
            let remaining = appState.currentWorkout?.adjustedRestTime || appState.settings.restTime;

            overlay.classList.add('show');
            timerDisplay.textContent = remaining;

            clearInterval(appState.restTimerInterval);
            appState.restTimerInterval = setInterval(() => {
                remaining--;
                timerDisplay.textContent = remaining;
                if (remaining <= 3 && remaining > 0) playBeep(600, 100);
                if (remaining <= 0) {
                    clearInterval(appState.restTimerInterval);
                    overlay.classList.remove('show');
                    playRestEndSound();
                }
            }, 1000);
        }

        function skipRest() {
            clearInterval(appState.restTimerInterval);
            document.getElementById('restOverlay').classList.remove('show');
        }

        function finishWorkout() {
            clearInterval(appState.mainTimerInterval);

            const duration = Math.floor((Date.now() - appState.workoutStartTime) / 1000);
            let totalVolume = 0;
            let totalSeries = 0;

            appState.currentExerciseData.forEach(ex => {
                ex.completedSets.forEach(set => {
                    totalVolume += set.weight * set.reps;
                    totalSeries++;
                });

                if (ex.completedSets.length > 0) {
                    if (!appState.exerciseHistory[ex.id]) appState.exerciseHistory[ex.id] = [];
                    const avgWeight = ex.completedSets.reduce((a, b) => a + b.weight, 0) / ex.completedSets.length;
                    appState.exerciseHistory[ex.id].push({
                        date: new Date().toISOString(),
                        weight: avgWeight,
                        sets: ex.completedSets
                    });
                }
            });

            const session = {
                id: Date.now(),
                date: new Date().toISOString(),
                type: 'musculation',
                workoutId: appState.currentWorkout.id,
                workoutName: appState.currentWorkout.name,
                programId: appState.currentCycle?.programId,
                isBodyweight: appState.currentWorkout.isBodyweight,
                duration,
                totalVolume,
                totalSeries,
                exercises: appState.currentExerciseData
            };

            appState.sessions.push(session);

            if (appState.currentCycle) {
                appState.currentCycle.sessionsCompleted++;
                appState.currentCycle.currentWorkoutIndex++;
            }

            saveState();

            const minutes = Math.floor(duration / 60).toString().padStart(2, '0');
            const seconds = (duration % 60).toString().padStart(2, '0');
            document.getElementById('summaryDuration').textContent = `${minutes}:${seconds}`;
            document.getElementById('summaryVolume').textContent = Math.round(totalVolume);
            document.getElementById('summarySeries').textContent = totalSeries;

            document.getElementById('summaryModal').classList.add('show');
            playSuccessSound();

            // Auto-export if enabled
            if (appState.settings.autoExportEnabled) {
                setTimeout(() => {
                    exportData();
                }, 500);
            }
        }

        function closeSummary() {
            document.getElementById('summaryModal').classList.remove('show');
            appState.currentWorkout = null;
            updateUI();
            showPage('homePage');
            checkCycleEnd();
        }

        // ==================== CARDIO ====================
        let selectedCardioType = 'running';

        function showCardioForm() {
            document.getElementById('cardioModal').classList.add('show');
        }

        function closeCardioModal() {
            document.getElementById('cardioModal').classList.remove('show');
        }

        function selectCardioType(type) {
            selectedCardioType = type;
            document.querySelectorAll('.session-type-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
        }

        function saveCardioSession() {
            const duration = parseInt(document.getElementById('cardioDuration').value) || 0;
            const distance = parseFloat(document.getElementById('cardioDistance').value) || 0;
            const elevation = parseInt(document.getElementById('cardioElevation').value) || 0;

            if (duration <= 0) {
                showToast('Veuillez entrer une dur√©e');
                return;
            }

            const avgSpeed = distance > 0 && duration > 0 ? (distance / (duration / 60)).toFixed(1) : 0;

            const session = {
                id: Date.now(),
                date: new Date().toISOString(),
                type: 'cardio',
                cardioType: selectedCardioType,
                duration: duration * 60,
                distance,
                elevation,
                avgSpeed: parseFloat(avgSpeed)
            };

            appState.cardioSessions.push(session);
            appState.sessions.push(session);
            saveState();

            document.getElementById('cardioDuration').value = '';
            document.getElementById('cardioDistance').value = '';
            document.getElementById('cardioElevation').value = '';

            closeCardioModal();
            updateUI();
            showToast('Sortie cardio enregistr√©e !');
            playSuccessSound();
        }

        // ==================== CROSSFIT ====================
        let selectedCrossfitType = 'wod';
        let selectedWod = null;
        let wodTabMode = 'random';

        function showCrossfitForm() {
            document.getElementById('crossfitModal').classList.add('show');
            selectedCrossfitType = 'wod';
            selectedWod = null;
            wodTabMode = 'random';
            updateCrossfitUI();
            renderWodGrid();
        }

        function closeCrossfitModal() {
            document.getElementById('crossfitModal').classList.remove('show');
            selectedWod = null;
            document.getElementById('wodPreview').style.display = 'none';
        }

        function selectCrossfitType(type) {
            selectedCrossfitType = type;
            document.querySelectorAll('.crossfit-type-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-cftype="${type}"]`).classList.add('active');
            updateCrossfitUI();
        }

        function updateCrossfitUI() {
            const wodSection = document.getElementById('wodSection');
            const halteroGymSection = document.getElementById('halteroGymSection');
            const roundsGroup = document.getElementById('crossfitRoundsGroup');

            if (selectedCrossfitType === 'wod') {
                wodSection.style.display = 'block';
                halteroGymSection.style.display = 'none';
                roundsGroup.style.display = 'block';
            } else {
                wodSection.style.display = 'none';
                halteroGymSection.style.display = 'block';
                roundsGroup.style.display = 'none';
            }
        }

        function switchWodTab(tab) {
            wodTabMode = tab;
            document.querySelectorAll('.wod-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            if (tab === 'random') {
                document.getElementById('wodRandomTab').style.display = 'block';
                document.getElementById('wodSelectTab').style.display = 'none';
            } else {
                document.getElementById('wodRandomTab').style.display = 'none';
                document.getElementById('wodSelectTab').style.display = 'block';
            }
        }

        function renderWodGrid() {
            const container = document.getElementById('wodGrid');
            let html = '';

            Object.entries(CROSSFIT_WODS).forEach(([id, wod]) => {
                const typeLabel = wod.type === 'amrap' ? 'AMRAP' : wod.type === 'emom' ? 'EMOM' : 'For Time';
                html += `
                    <div class="wod-card ${selectedWod === id ? 'active' : ''}" onclick="selectWod('${id}')">
                        <div class="wod-name">${wod.name}</div>
                        <div class="wod-type">${typeLabel}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function selectWod(wodId) {
            selectedWod = wodId;
            renderWodGrid();
            showWodPreview(CROSSFIT_WODS[wodId]);
        }

        function generateRandomWod() {
            const wodIds = Object.keys(CROSSFIT_WODS);
            const randomId = wodIds[Math.floor(Math.random() * wodIds.length)];
            selectedWod = randomId;
            showWodPreview(CROSSFIT_WODS[randomId]);
            playBeep(600, 100);
        }

        function showWodPreview(wod) {
            document.getElementById('wodPreview').style.display = 'block';
            document.getElementById('wodPreviewName').textContent = wod.name;

            let typeStr = wod.type === 'amrap' ? `AMRAP ${wod.duration || ''} min` :
                          wod.type === 'emom' ? `EMOM ${wod.duration || ''} min` :
                          wod.type === 'fortime' ? 'For Time' : wod.type;
            if (wod.reps) typeStr += ` (${wod.reps})`;
            if (wod.rounds) typeStr += ` - ${wod.rounds} rounds`;

            document.getElementById('wodPreviewType').textContent = typeStr;
            document.getElementById('wodPreviewExercises').innerHTML = wod.exercises.map(e => `‚Ä¢ ${e}`).join('<br>');
        }

        function saveCrossfitSession() {
            const duration = parseInt(document.getElementById('crossfitDuration').value) || 0;
            const rounds = parseInt(document.getElementById('crossfitRounds').value) || 0;
            const notes = document.getElementById('crossfitNotes').value || '';

            if (duration <= 0) {
                showToast('Veuillez entrer une dur√©e');
                return;
            }

            const crossfitIcons = { wod: 'üî•', haltero: 'üèãÔ∏è‚Äç‚ôÇÔ∏è', gym: 'ü§∏' };
            const crossfitNames = { wod: 'WOD', haltero: 'Halt√©rophilie', gym: 'Gymnastique' };

            const session = {
                id: Date.now(),
                date: new Date().toISOString(),
                type: 'crossfit',
                crossfitType: selectedCrossfitType,
                wodId: selectedWod,
                wodName: selectedWod ? CROSSFIT_WODS[selectedWod].name : null,
                duration: duration * 60,
                rounds,
                notes,
                icon: crossfitIcons[selectedCrossfitType],
                displayName: selectedWod ? CROSSFIT_WODS[selectedWod].name : crossfitNames[selectedCrossfitType]
            };

            appState.crossfitSessions.push(session);
            appState.sessions.push(session);
            saveState();

            document.getElementById('crossfitDuration').value = '';
            document.getElementById('crossfitRounds').value = '';
            document.getElementById('crossfitNotes').value = '';
            document.getElementById('wodPreview').style.display = 'none';
            selectedWod = null;

            closeCrossfitModal();
            updateUI();
            showToast('S√©ance CrossFit enregistr√©e !');
            playSuccessSound();
        }

        // ==================== STATS ====================
        function updateStats() {
            const totalMuscu = appState.sessions.filter(s => s.type === 'musculation').length;
            const totalCardio = appState.cardioSessions.length;
            const totalCrossfit = appState.crossfitSessions.length;
            const totalVolume = appState.sessions.filter(s => s.type === 'musculation').reduce((a, b) => a + (b.totalVolume || 0), 0);
            const totalTime = appState.sessions.reduce((a, b) => a + (b.duration || 0), 0);

            document.getElementById('statTotalSessions').textContent = totalMuscu;
            document.getElementById('statTotalVolume').textContent = (totalVolume / 1000).toFixed(1);
            document.getElementById('statTotalTime').textContent = (totalTime / 3600).toFixed(1);
            document.getElementById('statCardioCount').textContent = totalCardio;
            document.getElementById('statCrossfitCount').textContent = totalCrossfit;

            const select = document.getElementById('exerciseSelect');
            const existingOptions = new Set([...select.options].map(o => o.value));

            Object.keys(appState.exerciseHistory).forEach(exId => {
                if (!existingOptions.has(exId) && appState.exerciseHistory[exId].length > 0) {
                    const option = document.createElement('option');
                    option.value = exId;
                    option.textContent = exId;
                    select.appendChild(option);
                }
            });

            updateChart();
            drawWeightChart();
            renderHistory();
        }

        let chartInitialized = false;

        function updateChart() {
            const canvas = document.getElementById('progressChart');
            const ctx = canvas.getContext('2d');
            const selectedExercise = document.getElementById('exerciseSelect').value;

            // Initialiser le canvas si n√©cessaire (quand la page devient visible)
            if (!chartInitialized && canvas.offsetWidth > 0 && canvas.offsetHeight > 0) {
                canvas.width = canvas.offsetWidth * 2;
                canvas.height = canvas.offsetHeight * 2;
                ctx.scale(2, 2);
                chartInitialized = true;
            }

            // Dimensions d'affichage (le canvas est scal√© x2 pour la haute r√©solution)
            const displayWidth = canvas.width / 2;
            const displayHeight = canvas.height / 2;

            // Ne pas dessiner si le canvas n'est pas initialis√©
            if (displayWidth === 0 || displayHeight === 0) return;

            ctx.clearRect(0, 0, displayWidth, displayHeight);

            let data = [];
            let labels = [];

            if (selectedExercise === 'volume') {
                const muscuSessions = appState.sessions.filter(s => s.type === 'musculation').slice(-10);
                data = muscuSessions.map(s => s.totalVolume || 0);
                labels = muscuSessions.map(s => new Date(s.date).toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
            } else {
                const history = appState.exerciseHistory[selectedExercise] || [];
                const last10 = history.slice(-10);
                data = last10.map(h => h.weight);
                labels = last10.map(h => new Date(h.date).toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
            }

            if (data.length === 0) {
                ctx.fillStyle = '#6c6c8a';
                ctx.font = '14px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Pas encore de donn√©es', displayWidth / 2, displayHeight / 2);
                return;
            }

            const padding = 40;
            const width = displayWidth - padding * 2;
            const height = displayHeight - padding * 2;
            const maxValue = Math.max(...data) * 1.1;
            const minValue = Math.min(...data) * 0.9;
            const range = maxValue - minValue || 1;

            ctx.beginPath();
            ctx.strokeStyle = '#e94560';
            ctx.lineWidth = 3;

            data.forEach((value, index) => {
                const x = padding + (index / (data.length - 1 || 1)) * width;
                const y = padding + height - ((value - minValue) / range) * height;
                if (index === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();

            data.forEach((value, index) => {
                const x = padding + (index / (data.length - 1 || 1)) * width;
                const y = padding + height - ((value - minValue) / range) * height;
                ctx.beginPath();
                ctx.fillStyle = '#e94560';
                ctx.arc(x, y, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.fillStyle = '#0f0f1a';
                ctx.arc(x, y, 3, 0, Math.PI * 2);
                ctx.fill();
            });

            ctx.fillStyle = '#6c6c8a';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            labels.forEach((label, index) => {
                const x = padding + (index / (labels.length - 1 || 1)) * width;
                ctx.fillText(label, x, displayHeight - 10);
            });
        }

        let weightChartInitialized = false;

        function drawWeightChart() {
            const container = document.getElementById('weightChartContainer');
            const canvas = document.getElementById('weightChart');
            const ctx = canvas.getContext('2d');

            if (!appState.weightLossGoal || appState.weightHistory.length < 2) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';

            // Initialize the canvas if necessary
            if (!weightChartInitialized && canvas.offsetWidth > 0 && canvas.offsetHeight > 0) {
                canvas.width = canvas.offsetWidth * 2;
                canvas.height = canvas.offsetHeight * 2;
                ctx.scale(2, 2);
                weightChartInitialized = true;
            }

            const displayWidth = canvas.width / 2;
            const displayHeight = canvas.height / 2;

            if (displayWidth === 0 || displayHeight === 0) return;

            ctx.clearRect(0, 0, displayWidth, displayHeight);

            const history = appState.weightHistory.slice(-15);
            const goal = appState.weightLossGoal;
            const data = history.map(h => h.weight);
            const labels = history.map(h => new Date(h.date).toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));

            const padding = 40;
            const width = displayWidth - padding * 2;
            const height = displayHeight - padding * 2;
            const maxValue = Math.max(...data, goal.startWeight) * 1.02;
            const minValue = Math.min(...data, goal.targetWeight) * 0.98;
            const range = maxValue - minValue || 1;

            // Draw target line
            const targetY = padding + height - ((goal.targetWeight - minValue) / range) * height;
            ctx.beginPath();
            ctx.strokeStyle = '#00d26a';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.moveTo(padding, targetY);
            ctx.lineTo(displayWidth - padding, targetY);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw weight line
            ctx.beginPath();
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;

            data.forEach((value, index) => {
                const x = padding + (index / (data.length - 1 || 1)) * width;
                const y = padding + height - ((value - minValue) / range) * height;
                if (index === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();

            // Draw points
            data.forEach((value, index) => {
                const x = padding + (index / (data.length - 1 || 1)) * width;
                const y = padding + height - ((value - minValue) / range) * height;
                ctx.beginPath();
                ctx.fillStyle = '#667eea';
                ctx.arc(x, y, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.fillStyle = '#0f0f1a';
                ctx.arc(x, y, 3, 0, Math.PI * 2);
                ctx.fill();
            });

            // Draw labels
            ctx.fillStyle = '#6c6c8a';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            labels.forEach((label, index) => {
                const x = padding + (index / (labels.length - 1 || 1)) * width;
                ctx.fillText(label, x, displayHeight - 10);
            });

            // Draw target label
            ctx.fillStyle = '#00d26a';
            ctx.textAlign = 'right';
            ctx.fillText(`Objectif: ${goal.targetWeight}kg`, displayWidth - padding, targetY - 5);
        }

        function renderHistory() {
            const container = document.getElementById('historyList');
            const allSessions = [...appState.sessions].reverse().slice(0, 20);

            if (allSessions.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted); text-align: center;">Aucune s√©ance</p>';
                return;
            }

            const cardioIcons = { running: 'üèÉ', cycling: 'üö¥', swimming: 'üèä', other: 'üí™' };

            let html = '';
            allSessions.forEach(session => {
                const date = new Date(session.date);
                const dateStr = date.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });

                if (session.type === 'cardio') {
                    const minutes = Math.floor(session.duration / 60);
                    html += `
                        <div class="history-item">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${cardioIcons[session.cardioType] || 'üí™'} ${session.cardioType === 'running' ? 'Course' : session.cardioType === 'cycling' ? 'V√©lo' : session.cardioType === 'swimming' ? 'Piscine' : 'Cardio'}</div>
                            <div class="history-stats">
                                <div class="history-stat">‚è±Ô∏è ${minutes} min</div>
                                ${session.distance ? `<div class="history-stat">üìç ${session.distance} km</div>` : ''}
                                ${session.avgSpeed ? `<div class="history-stat">‚ö° ${session.avgSpeed} km/h</div>` : ''}
                            </div>
                        </div>
                    `;
                } else if (session.type === 'crossfit') {
                    const minutes = Math.floor(session.duration / 60);
                    const crossfitIcons = { wod: 'üî•', haltero: 'üèãÔ∏è‚Äç‚ôÇÔ∏è', gym: 'ü§∏' };
                    const icon = crossfitIcons[session.crossfitType] || 'üèãÔ∏è';
                    html += `
                        <div class="history-item">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${icon} ${session.displayName || 'CrossFit'}</div>
                            <div class="history-stats">
                                <div class="history-stat">‚è±Ô∏è ${minutes} min</div>
                                ${session.rounds ? `<div class="history-stat">üîÑ ${session.rounds} rounds</div>` : ''}
                                ${session.notes ? `<div class="history-stat">üìù ${session.notes}</div>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    const minutes = Math.floor(session.duration / 60);
                    const icon = session.isBodyweight ? 'üß≥' : 'üèãÔ∏è';
                    html += `
                        <div class="history-item">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${icon} ${session.workoutName}</div>
                            <div class="history-stats">
                                <div class="history-stat">‚è±Ô∏è ${minutes} min</div>
                                ${session.totalVolume > 0 ? `<div class="history-stat">üí™ ${session.totalVolume} kg</div>` : ''}
                                <div class="history-stat">üìä ${session.totalSeries} s√©ries</div>
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html;
        }

        // ==================== UI UPDATES ====================
        function updateUI() {
            updateGreeting();
            updateCycleDisplay();
            updateHomeStats();
            updateRecentSessions();
            updateCycleSettings();
            updateWeightGoalUI();
            updateSessionsIndicator();
        }

        function updateGreeting() {
            const hour = new Date().getHours();
            let greeting = hour < 12 ? 'Bonjour' : hour < 18 ? 'Bon apr√®s-midi' : 'Bonsoir';
            document.getElementById('greeting').textContent = `${greeting} ! Pr√™t √† t'entra√Æner ?`;
        }

        function updateCycleDisplay() {
            const container = document.getElementById('cycleDisplay');

            if (!appState.currentCycle) {
                container.innerHTML = `
                    <div class="no-cycle-card">
                        <h3>Aucun programme actif</h3>
                        <p>Choisis un programme pour structurer tes entra√Ænements</p>
                        <button class="btn btn-primary btn-small" onclick="showProgramSelection()">Choisir un programme</button>
                    </div>
                `;
                return;
            }

            const cycle = appState.currentCycle;
            const program = PROGRAMS[cycle.programId];
            const startDate = new Date(cycle.startDate);
            const endDate = new Date(cycle.endDate);
            const now = new Date();
            const totalDays = (endDate - startDate) / (1000 * 60 * 60 * 24);
            const elapsedDays = Math.max(0, (now - startDate) / (1000 * 60 * 60 * 24));
            const progress = Math.min(100, (elapsedDays / totalDays) * 100);
            const weeksRemaining = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24 * 7)));

            const nextWorkout = getNextWorkout();

            container.innerHTML = `
                <div class="cycle-card ${program.gradient}">
                    <div class="cycle-header">
                        <div class="cycle-name">${program.icon} ${program.name}</div>
                        <div class="cycle-duration">${weeksRemaining} sem. restantes</div>
                    </div>
                    <div class="cycle-progress">
                        <div class="cycle-progress-bar" style="width: ${progress}%"></div>
                    </div>
                    <div class="cycle-stats">
                        <span>${cycle.sessionsCompleted} s√©ances</span>
                        <span>Semaine ${Math.ceil(elapsedDays / 7)} / ${cycle.durationWeeks}</span>
                    </div>
                </div>

                ${nextWorkout ? `
                    <div class="next-session">
                        <div class="next-session-label">Prochaine s√©ance</div>
                        <div class="next-session-title">${nextWorkout.name}</div>
                    </div>
                ` : ''}
            `;
        }

        function updateHomeStats() {
            const now = new Date();
            const weekStart = new Date(now);
            weekStart.setDate(now.getDate() - now.getDay());
            weekStart.setHours(0, 0, 0, 0);

            const weekSessions = appState.sessions.filter(s => new Date(s.date) >= weekStart && s.type === 'musculation');
            const weekVolume = weekSessions.reduce((a, b) => a + (b.totalVolume || 0), 0);
            const totalSessions = appState.sessions.filter(s => s.type === 'musculation').length;

            let streak = 0;
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            for (let i = 0; i < 365; i++) {
                const checkDate = new Date(today);
                checkDate.setDate(today.getDate() - i);
                const hasSession = appState.sessions.some(s => {
                    const sessionDate = new Date(s.date);
                    sessionDate.setHours(0, 0, 0, 0);
                    return sessionDate.getTime() === checkDate.getTime();
                });
                if (hasSession || i === 0) {
                    if (hasSession) streak++;
                } else break;
            }

            document.getElementById('weekSessions').textContent = weekSessions.length;
            document.getElementById('totalVolume').textContent = Math.round(weekVolume);
            document.getElementById('totalSessions').textContent = totalSessions;
            document.getElementById('currentStreak').textContent = streak;
        }

        function updateRecentSessions() {
            const container = document.getElementById('recentSessions');
            const recent = [...appState.sessions].reverse().slice(0, 3);

            if (recent.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted); text-align: center;">Aucune s√©ance</p>';
                return;
            }

            const cardioIcons = { running: 'üèÉ', cycling: 'üö¥', swimming: 'üèä', other: 'üí™' };

            let html = '';
            recent.forEach(session => {
                const date = new Date(session.date);
                const dateStr = date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' });
                const minutes = Math.floor(session.duration / 60);

                if (session.type === 'cardio') {
                    html += `
                        <div class="history-item" style="margin-bottom: 8px;">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${cardioIcons[session.cardioType] || 'üí™'} Cardio</div>
                            <div class="history-stats">
                                <span class="history-stat">‚è±Ô∏è ${minutes} min</span>
                            </div>
                        </div>
                    `;
                } else if (session.type === 'crossfit') {
                    const crossfitIcons = { wod: 'üî•', haltero: 'üèãÔ∏è‚Äç‚ôÇÔ∏è', gym: 'ü§∏' };
                    const icon = crossfitIcons[session.crossfitType] || 'üèãÔ∏è';
                    html += `
                        <div class="history-item" style="margin-bottom: 8px;">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${icon} ${session.displayName || 'CrossFit'}</div>
                            <div class="history-stats">
                                <span class="history-stat">‚è±Ô∏è ${minutes} min</span>
                                ${session.rounds ? `<span class="history-stat">üîÑ ${session.rounds} rds</span>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    const icon = session.isBodyweight ? 'üß≥' : 'üèãÔ∏è';
                    html += `
                        <div class="history-item" style="margin-bottom: 8px;">
                            <div class="history-date">${dateStr}</div>
                            <div class="history-title">${icon} ${session.workoutName}</div>
                            <div class="history-stats">
                                <span class="history-stat">‚è±Ô∏è ${minutes} min</span>
                                ${session.totalVolume > 0 ? `<span class="history-stat">üí™ ${session.totalVolume} kg</span>` : ''}
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html;
        }

        function updateCycleSettings() {
            const container = document.getElementById('cycleSettingsInfo');
            if (!appState.currentCycle) {
                container.innerHTML = '<p style="color: var(--text-muted);">Aucun programme actif</p>';
                return;
            }

            const cycle = appState.currentCycle;
            const program = PROGRAMS[cycle.programId];
            const endDate = new Date(cycle.endDate).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' });

            container.innerHTML = `
                <p><strong>${program.icon} ${program.name}</strong></p>
                <p style="color: var(--text-secondary); font-size: 14px;">
                    Fin pr√©vue : ${endDate}<br>
                    ${cycle.sessionsCompleted} s√©ances effectu√©es
                </p>
            `;
        }

        // ==================== WEIGHT GOAL ====================
        function openWeightGoalModal() {
            const modal = document.getElementById('weightGoalModal');
            const goal = appState.weightLossGoal;

            if (goal) {
                document.getElementById('weightGoalStart').value = goal.startWeight;
                document.getElementById('weightGoalTarget').value = goal.targetWeight;
                document.getElementById('weightGoalDate').value = goal.targetDate.split('T')[0];
            } else {
                document.getElementById('weightGoalStart').value = '';
                document.getElementById('weightGoalTarget').value = '';
                // Default to 3 months from now
                const targetDate = new Date();
                targetDate.setMonth(targetDate.getMonth() + 3);
                document.getElementById('weightGoalDate').value = targetDate.toISOString().split('T')[0];
            }

            modal.classList.add('show');
        }

        function closeWeightGoalModal() {
            document.getElementById('weightGoalModal').classList.remove('show');
        }

        function saveWeightGoal() {
            const startWeight = parseFloat(document.getElementById('weightGoalStart').value);
            const targetWeight = parseFloat(document.getElementById('weightGoalTarget').value);
            const targetDate = document.getElementById('weightGoalDate').value;

            if (!startWeight || !targetWeight || !targetDate) {
                showToast('Veuillez remplir tous les champs');
                return;
            }

            appState.weightLossGoal = {
                startWeight,
                targetWeight,
                startDate: new Date().toISOString(),
                targetDate: new Date(targetDate).toISOString()
            };

            // Add initial weight to history if empty
            if (appState.weightHistory.length === 0) {
                appState.weightHistory.push({
                    date: new Date().toISOString(),
                    weight: startWeight
                });
            }

            saveState();
            closeWeightGoalModal();
            updateWeightGoalUI();
            showToast('Objectif enregistr√© !');
        }

        function clearWeightGoal() {
            if (confirm('Supprimer l\'objectif poids ?')) {
                appState.weightLossGoal = null;
                appState.weightHistory = [];
                saveState();
                closeWeightGoalModal();
                updateWeightGoalUI();
                showToast('Objectif supprim√©');
            }
        }

        function openWeightEntryModal() {
            const modal = document.getElementById('weightEntryModal');
            document.getElementById('weightEntryValue').value = '';
            document.getElementById('weightEntryDate').value = new Date().toISOString().split('T')[0];
            modal.classList.add('show');
        }

        function closeWeightEntryModal() {
            document.getElementById('weightEntryModal').classList.remove('show');
        }

        function addWeightEntry() {
            const weight = parseFloat(document.getElementById('weightEntryValue').value);
            const date = document.getElementById('weightEntryDate').value;

            if (!weight) {
                showToast('Veuillez entrer un poids');
                return;
            }

            appState.weightHistory.push({
                date: new Date(date).toISOString(),
                weight
            });

            // Sort by date
            appState.weightHistory.sort((a, b) => new Date(a.date) - new Date(b.date));

            saveState();
            closeWeightEntryModal();
            updateWeightGoalUI();
            showToast('Pes√©e enregistr√©e !');
        }

        function updateWeightGoalUI() {
            const card = document.getElementById('weightGoalCard');
            const settingsInfo = document.getElementById('weightGoalSettingsInfo');
            const addWeightBtn = document.getElementById('addWeightBtn');

            if (!appState.weightLossGoal) {
                card.style.display = 'none';
                addWeightBtn.style.display = 'none';
                settingsInfo.innerHTML = '<p style="color: var(--text-muted); font-size: 14px;">Aucun objectif d√©fini</p>';
                return;
            }

            card.style.display = 'block';
            addWeightBtn.style.display = 'inline-flex';

            const goal = appState.weightLossGoal;
            const history = appState.weightHistory;
            const currentWeight = history.length > 0 ? history[history.length - 1].weight : goal.startWeight;
            const totalToLose = goal.startWeight - goal.targetWeight;
            const lost = goal.startWeight - currentWeight;
            const progress = Math.max(0, Math.min(100, (lost / totalToLose) * 100));
            const remaining = currentWeight - goal.targetWeight;

            // Calculate weekly change
            let weeklyChange = '--';
            if (history.length >= 2) {
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                const weekAgoEntry = history.find(h => new Date(h.date) <= oneWeekAgo);
                if (weekAgoEntry) {
                    const change = currentWeight - weekAgoEntry.weight;
                    weeklyChange = change > 0 ? `+${change.toFixed(1)} kg` : `${change.toFixed(1)} kg`;
                } else if (history.length >= 2) {
                    const change = currentWeight - history[history.length - 2].weight;
                    weeklyChange = change > 0 ? `+${change.toFixed(1)} kg` : `${change.toFixed(1)} kg`;
                }
            }

            document.getElementById('weightCurrentDisplay').textContent = `${currentWeight.toFixed(1)} kg`;
            document.getElementById('weightTargetDisplay').textContent = `Objectif: ${goal.targetWeight} kg`;
            document.getElementById('weightProgressFill').style.width = `${progress}%`;
            document.getElementById('weightWeeklyChange').textContent = weeklyChange !== '--' ? `${weeklyChange} cette semaine` : '';
            document.getElementById('weightRemaining').textContent = remaining > 0 ? `${remaining.toFixed(1)} kg restants` : 'Objectif atteint !';

            // Update settings info
            settingsInfo.innerHTML = `
                <p style="font-size: 14px;">
                    <strong>${currentWeight.toFixed(1)} kg</strong> ‚Üí <strong>${goal.targetWeight} kg</strong>
                    <br><span style="color: var(--text-muted);">${progress.toFixed(0)}% accompli</span>
                </p>
            `;
        }

        function updateSessionsIndicator() {
            const now = new Date();
            const weekStart = new Date(now);
            weekStart.setDate(now.getDate() - now.getDay());
            weekStart.setHours(0, 0, 0, 0);

            const weekSessions = appState.sessions.filter(s =>
                new Date(s.date) >= weekStart && s.type === 'musculation'
            ).length;

            const target = appState.settings.sessionsPerWeek;
            const indicator = document.getElementById('sessionsIndicator');
            const display = document.getElementById('sessionsCountDisplay');

            display.textContent = `${weekSessions}/${target}`;

            if (weekSessions >= target) {
                indicator.classList.add('reached');
            } else {
                indicator.classList.remove('reached');
            }
        }

        // ==================== LEVEL ADAPTATION ====================
        function getLevelAdjustments() {
            const level = appState.settings.userLevel;
            switch (level) {
                case 'debutant':
                    return { setsModifier: -1, restModifier: 30, maxExercises: 4 };
                case 'avance':
                    return { setsModifier: 1, restModifier: -15, maxExercises: 99 };
                default: // intermediaire
                    return { setsModifier: 0, restModifier: 0, maxExercises: 99 };
            }
        }

        // ==================== SETTINGS ====================
        function toggleSound() {
            appState.settings.soundEnabled = document.getElementById('soundToggle').checked;
            saveState();
            if (appState.settings.soundEnabled) playBeep(800, 100);
        }

        function updateRestTime() {
            appState.settings.restTime = parseInt(document.getElementById('restTimeSelect').value);
            saveState();
        }

        function updateUserLevel() {
            appState.settings.userLevel = document.getElementById('userLevelSelect').value;
            saveState();
            showToast(`Niveau: ${appState.settings.userLevel}`);
        }

        function toggleBiset() {
            appState.settings.bisetEnabled = document.getElementById('bisetToggle').checked;
            saveState();
        }

        function updateSessionsPerWeek() {
            appState.settings.sessionsPerWeek = parseInt(document.getElementById('sessionsPerWeekSelect').value);
            saveState();
            updateSessionsIndicator();
        }

        function toggleAutoExport() {
            appState.settings.autoExportEnabled = document.getElementById('autoExportToggle').checked;
            saveState();
        }

        // ==================== INIT ====================
        function init() {
            loadState();
            updateUI();
        }

        document.addEventListener('DOMContentLoaded', init);

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(() => {});
        }
    </script>
</body>
</html>
